var Pt=Object.create;var Me=Object.defineProperty;var Et=Object.getOwnPropertyDescriptor;var Mt=Object.getOwnPropertyNames;var vt=Object.getPrototypeOf,Rt=Object.prototype.hasOwnProperty;var xn=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),se=(n,e)=>{for(var t in e)Me(n,t,{get:e[t],enumerable:!0})},jt=(n,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Mt(e))!Rt.call(n,r)&&r!==t&&Me(n,r,{get:()=>e[r],enumerable:!(s=Et(e,r))||s.enumerable});return n};var _t=(n,e,t)=>(t=n!=null?Pt(vt(n)):{},jt(e||!n||!n.__esModule?Me(t,"default",{value:n,enumerable:!0}):t,n));var It=xn(Ae=>{Ae.parse=function(n,e){if(e?e.offsets=typeof e.offsets>"u"?!0:e.offsets:e={offsets:!0},n||(n=""),n.indexOf(":")===-1&&!e.tokenize)return n;if(!e.keywords&&!e.ranges&&!e.tokenize)return n;var t={text:[]};e.offsets&&(t.offsets=[]);for(var s={},r=[],u=/(\S+:'(?:[^'\\]|\\.)*')|(\S+:"(?:[^"\\]|\\.)*")|(-?"(?:[^"\\]|\\.)*")|(-?'(?:[^'\\]|\\.)*')|\S+|\S+:\S+/g,o;(o=u.exec(n))!==null;){var f=o[0],i=f.indexOf(":");if(i!==-1){var p=f.split(":"),I=f.slice(0,i),l=f.slice(i+1);l=l.replace(/^\"|\"$|^\'|\'$/g,""),l=(l+"").replace(/\\(.?)/g,function(M,D){switch(D){case"\\":return"\\";case"0":return"\0";case"":return"";default:return D}}),r.push({keyword:I,value:l,offsetStart:o.index,offsetEnd:o.index+f.length})}else{var d=!1;f[0]==="-"&&(d=!0,f=f.slice(1)),f=f.replace(/^\"|\"$|^\'|\'$/g,""),f=(f+"").replace(/\\(.?)/g,function(M,D){switch(D){case"\\":return"\\";case"0":return"\0";case"":return"";default:return D}}),d?s.text?(s.text instanceof Array||(s.text=[s.text]),s.text.push(f)):s.text=f:r.push({text:f,offsetStart:o.index,offsetEnd:o.index+f.length})}}r.reverse();for(var f;f=r.pop();)if(f.text)t.text.push(f.text),e.offsets&&t.offsets.push(f);else{var I=f.keyword;e.keywords=e.keywords||[];var T=!1,k=!1;if(!/^-/.test(I))T=e.keywords.indexOf(I)!==-1;else if(I[0]==="-"){var y=I.slice(1);T=e.keywords.indexOf(y)!==-1,T&&(I=y,k=!0)}e.ranges=e.ranges||[];var h=e.ranges.indexOf(I)!==-1;if(T){e.offsets&&t.offsets.push({keyword:I,value:f.value,offsetStart:k?f.offsetStart+1:f.offsetStart,offsetEnd:f.offsetEnd});var x=f.value;if(x.length){var g=x.split(",");k?s[I]?s[I]instanceof Array?g.length>1?s[I]=s[I].concat(g):s[I].push(x):(s[I]=[s[I]],s[I].push(x)):g.length>1?s[I]=g:e.alwaysArray?s[I]=[x]:s[I]=x:t[I]?t[I]instanceof Array?g.length>1?t[I]=t[I].concat(g):t[I].push(x):(t[I]=[t[I]],t[I].push(x)):g.length>1?t[I]=g:e.alwaysArray?t[I]=[x]:t[I]=x}}else if(h){e.offsets&&t.offsets.push(f);var x=f.value,w=x.split("-");t[I]={},w.length===2?(t[I].from=w[0],t[I].to=w[1]):!w.length%2||(t[I].from=x)}else{var A=f.keyword+":"+f.value;t.text.push(A),e.offsets&&t.offsets.push({text:A,offsetStart:f.offsetStart,offsetEnd:f.offsetEnd})}}return t.text.length?e.tokenize||(t.text=t.text.join(" ").trim()):delete t.text,t.exclude=s,t};Ae.stringify=function(n,e,t){if(e||(e={offsets:!0}),!n)return"";if(typeof n=="string")return n;if(Array.isArray(n))return n.join(" ");if(!Object.keys(n).length)return"";if(Object.keys(n).length===3&&n.text&&n.offsets&&n.exclude&&typeof n.text=="string")return n.text;t||(t="");var s=function(i){return i.indexOf(" ")>-1?JSON.stringify(i):i},r=function(i){return t+i},u=[];if(n.text){var o=[];typeof n.text=="string"?o.push(n.text):o.push.apply(o,n.text),o.length>0&&u.push(o.map(s).map(r).join(" "))}return e.keywords&&e.keywords.forEach(function(i){if(n[i]){var p=[];typeof n[i]=="string"?p.push(n[i]):p.push.apply(p,n[i]),p.length>0&&u.push(r(i+":"+p.map(s).join(",")))}}),e.ranges&&e.ranges.forEach(function(i){if(n[i]){var p=n[i].from,I=n[i].to;I&&(p=p+"-"+I),p&&u.push(r(i+":"+p))}}),n.exclude&&Object.keys(n.exclude).length>0&&u.push(Ae.stringify(n.exclude,e,"-")),u.join(" ")}});var mt=xn((wE,ct)=>{ct.exports=It()});function gn(n){let e=atob(n),t=e.length,s=new Uint8Array(t);for(let r=0;r<t;r++)s[r]=e.charCodeAt(r);return s}function ve(n){typeof n=="string"&&(n=new TextEncoder().encode(n));let e="",t=n.byteLength;for(let s=0;s<t;s++)e+=String.fromCharCode(n[s]);return btoa(e)}var pu=new Uint8Array(16);var Re=class{constructor(e="",t=1e3){this.prefix=e;this.maxCaptureSize=t;this.prefix=e,this.originalConsole={log:console.log.bind(console),info:console.info.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),debug:console.debug.bind(console)},this.patchConsole()}originalConsole;logBuffer=[];patchConsole(){let e=t=>(...s)=>{let r=this.prefix?[this.prefix,...s]:s;this.originalConsole[t](...r),this.captureLog(t,s)};console.log=e("log"),console.info=e("info"),console.warn=e("warn"),console.error=e("error"),console.debug=e("debug")}captureLog(e,t){let s={level:e,timestamp:Date.now(),message:t.map(r=>{if(typeof r=="string")return r;try{return JSON.stringify(r)}catch{return String(r)}}).join(" ")};this.logBuffer.push(s),this.logBuffer.length>this.maxCaptureSize&&this.logBuffer.shift()}async postToServer(e,t){if(this.logBuffer.length>0){let r=[...this.logBuffer];this.logBuffer=[];try{if(!(await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r.map(o=>({...o,source:t})))})).ok)throw new Error("Failed to post logs to server")}catch(u){console.warn("Could not post logs to server",u.message),this.logBuffer.unshift(...r)}}}},kn;function wn(n=""){return kn=new Re(n),kn}var re=n=>{throw new Error("Not initialized yet")},qe=typeof window>"u"&&typeof globalThis.WebSocketPair>"u";typeof Deno>"u"&&(self.Deno={args:[],build:{arch:"x86_64"},env:{get(){}}});var _e=new Map,je=0;qe&&(globalThis.syscall=async(n,...e)=>await new Promise((t,s)=>{je++,_e.set(je,{resolve:t,reject:s}),re({type:"sys",id:je,name:n,args:e})}));function On(n,e,t){qe&&(re=t,self.addEventListener("message",s=>{(async()=>{let r=s.data;switch(r.type){case"inv":{let u=n[r.name];if(!u)throw new Error(`Function not loaded: ${r.name}`);try{let o=await Promise.resolve(u(...r.args||[]));re({type:"invr",id:r.id,result:o})}catch(o){console.error("An exception was thrown as a result of invoking function",r.name,"error:",o.message),re({type:"invr",id:r.id,error:o.message})}}break;case"sysr":{let u=r.id,o=_e.get(u);if(!o)throw Error("Invalid request id");_e.delete(u),r.error?o.reject(new Error(r.error)):o.resolve(r.result)}break}})().catch(console.error)}),re({type:"manifest",manifest:e}),wn(`[${e.name} plug]`))}async function qt(n,e){if(typeof n!="string"){let t=new Uint8Array(await n.arrayBuffer()),s=t.length>0?ve(t):void 0;e={method:n.method,headers:Object.fromEntries(n.headers.entries()),base64Body:s},n=n.url}return syscall("sandboxFetch.fetch",n,e)}globalThis.nativeFetch=globalThis.fetch;function Dt(){globalThis.fetch=async function(n,e){let t=e&&e.body?ve(new Uint8Array(await new Response(e.body).arrayBuffer())):void 0,s=await qt(n,e&&{method:e.method,headers:e.headers,base64Body:t});return new Response(s.base64Body?gn(s.base64Body):null,{status:s.status,headers:s.headers})}}qe&&Dt();var R={};se(R,{alert:()=>gs,configureVimMode:()=>Ds,confirm:()=>xs,copyToClipboard:()=>vs,deleteLine:()=>Rs,dispatch:()=>ys,downloadFile:()=>us,filterBox:()=>as,flashNotification:()=>is,fold:()=>Os,foldAll:()=>Bs,getCurrentEditor:()=>Lt,getCurrentPage:()=>Ct,getCurrentPageMeta:()=>Wt,getCurrentPath:()=>Vt,getCursor:()=>$t,getRecentlyOpenedPages:()=>Nt,getSelection:()=>zt,getText:()=>Ft,getUiOption:()=>ks,goHistory:()=>rs,hidePanel:()=>Is,insertAtCursor:()=>Ts,insertAtPos:()=>ms,invokeCommand:()=>Gt,moveCursor:()=>ds,moveCursorToLine:()=>ls,moveLineDown:()=>_s,moveLineUp:()=>js,navigate:()=>Ht,newWindow:()=>ss,openCommandPalette:()=>Qt,openPageNavigator:()=>Xt,openSearchPanel:()=>Ms,openUrl:()=>ts,prompt:()=>hs,rebuildEditorState:()=>es,redo:()=>Es,reloadConfigAndCommands:()=>ns,reloadPage:()=>Zt,reloadUI:()=>Yt,replaceRange:()=>fs,save:()=>Jt,sendMessage:()=>Cs,setSelection:()=>Ut,setText:()=>Kt,setUiOption:()=>ws,showPanel:()=>ps,showProgress:()=>cs,toggleFold:()=>As,undo:()=>Ps,unfold:()=>Ss,unfoldAll:()=>bs,uploadFile:()=>os,vimEx:()=>qs});typeof self>"u"&&(self={syscall:()=>{throw new Error("Not implemented here")}});function c(n,...e){return globalThis.syscall(n,...e)}function Ct(){return c("editor.getCurrentPage")}function Wt(){return c("editor.getCurrentPageMeta")}function Vt(){return c("editor.getCurrentPath")}function Nt(){return c("editor.getRecentlyOpenedPages")}function Lt(){return c("editor.getCurrentEditor")}function Ft(){return c("editor.getText")}function Kt(n,e=!1){return c("editor.setText",n,e)}function $t(){return c("editor.getCursor")}function zt(){return c("editor.getSelection")}function Ut(n,e){return c("editor.setSelection",n,e)}function Gt(n,e){return c("editor.invokeCommand",n,e)}function Jt(){return c("editor.save")}function Ht(n,e=!1,t=!1){return c("editor.navigate",n,e,t)}function Xt(n="page"){return c("editor.openPageNavigator",n)}function Qt(){return c("editor.openCommandPalette")}function Zt(){return c("editor.reloadPage")}function Yt(){return c("editor.reloadUI")}function es(){return c("editor.rebuildEditorState")}function ns(){return c("editor.reloadConfigAndCommands")}function ts(n,e=!1){return c("editor.openUrl",n,e)}function ss(){return c("editor.newWindow")}function rs(n){return c("editor.goHistory",n)}function us(n,e){return c("editor.downloadFile",n,e)}function os(n,e){return c("editor.uploadFile",n,e)}function is(n,e="info"){return c("editor.flashNotification",n,e)}function as(n,e,t="",s=""){return c("editor.filterBox",n,e,t,s)}function ps(n,e,t,s=""){return c("editor.showPanel",n,e,t,s)}function Is(n){return c("editor.hidePanel",n)}function cs(n,e){return c("editor.showProgress",n,e)}function ms(n,e){return c("editor.insertAtPos",n,e)}function fs(n,e,t){return c("editor.replaceRange",n,e,t)}function ds(n,e=!1){return c("editor.moveCursor",n,e)}function ls(n,e=1,t=!1){return c("editor.moveCursorToLine",n,e,t)}function Ts(n,e=!1,t=!1){return c("editor.insertAtCursor",n,e,t)}function ys(n){return c("editor.dispatch",n)}function hs(n,e=""){return c("editor.prompt",n,e)}function xs(n){return c("editor.confirm",n)}function gs(n){return c("editor.alert",n)}function ks(n){return c("editor.getUiOption",n)}function ws(n,e){return c("editor.setUiOption",n,e)}function Os(){return c("editor.fold")}function Ss(){return c("editor.unfold")}function As(){return c("editor.toggleFold")}function Bs(){return c("editor.foldAll")}function bs(){return c("editor.unfoldAll")}function Ps(){return c("editor.undo")}function Es(){return c("editor.redo")}function Ms(){return c("editor.openSearchPanel")}function vs(n){return c("editor.copyToClipboard",n)}function Rs(){return c("editor.deleteLine")}function js(){return c("editor.moveLineUp")}function _s(){return c("editor.moveLineDown")}function qs(n){return c("editor.vimEx",n)}function Ds(){return c("editor.configureVimMode")}function Cs(n,e){return c("editor.sendMessage",n,e)}var V={};se(V,{deleteDocument:()=>Xs,deleteFile:()=>nr,deletePage:()=>$s,fileExists:()=>tr,getDocumentMeta:()=>Gs,getFileMeta:()=>Ys,getPageMeta:()=>Ns,listDocuments:()=>Us,listFiles:()=>Qs,listPages:()=>Vs,listPlugs:()=>zs,pageExists:()=>Ls,readDocument:()=>Js,readFile:()=>Zs,readPage:()=>Fs,writeDocument:()=>Hs,writeFile:()=>er,writePage:()=>Ks});function Vs(){return c("space.listPages")}function Ns(n){return c("space.getPageMeta",n)}function Ls(n){return c("space.pageExists",n)}function Fs(n){return c("space.readPage",n)}function Ks(n,e){return c("space.writePage",n,e)}function $s(n){return c("space.deletePage",n)}function zs(){return c("space.listPlugs")}function Us(){return c("space.listDocuments")}function Gs(n){return c("space.getDocumentMeta",n)}function Js(n){return c("space.readDocument",n)}function Hs(n,e){return c("space.writeDocument",n,e)}function Xs(n){return c("space.deleteDocument",n)}function Qs(){return c("space.listFiles")}function Zs(n){return c("space.readFile",n)}function Ys(n){return c("space.getFileMeta",n)}function er(n,e){return c("space.writeFile",n,e)}function nr(n){return c("space.deleteFile",n)}function tr(n){return c("space.fileExists",n)}var fe={};se(fe,{getConfig:()=>Ir,getMode:()=>ar,getVersion:()=>pr,invokeCommand:()=>rr,invokeFunction:()=>sr,listCommands:()=>ur,listSyscalls:()=>or,reloadPlugs:()=>ir,wipeClient:()=>cr});function sr(n,...e){return c("system.invokeFunction",n,...e)}function rr(n,e){return c("system.invokeCommand",n,e)}function ur(){return c("system.listCommands")}function or(){return c("system.listSyscalls")}function ir(){return c("system.reloadPlugs")}function ar(){return c("system.getMode")}function pr(){return c("system.getVersion")}function Ir(n,e=void 0){return c("system.getConfig",n,e)}function cr(n=!1){return c("system.wipeClient",n)}var W={};se(W,{del:()=>dr,get:()=>fr,set:()=>mr});function mr(n,e){return c("clientStore.set",n,e)}function fr(n){return c("clientStore.get",n)}function dr(n){return c("clientStore.delete",n)}var de={};se(de,{dispatchEvent:()=>xr,listEvents:()=>gr});function xr(n,e,t){return new Promise((s,r)=>{let u=-1;t&&(u=setTimeout(()=>{console.log("Timeout!"),r("timeout")},t)),c("event.dispatch",n,e).then(o=>{u!==-1&&clearTimeout(u),s(o)}).catch(r)})}function gr(){return c("event.listEvents")}var De='var fi=Object.defineProperty;var hn=A=>{throw TypeError(A)};var oi=(A,S,M)=>S in A?fi(A,S,{enumerable:!0,configurable:!0,writable:!0,value:M}):A[S]=M;var ct=(A,S,M)=>oi(A,typeof S!="symbol"?S+"":S,M),ar=(A,S,M)=>S.has(A)||hn("Cannot "+M);var k=(A,S,M)=>(ar(A,S,"read from private field"),M?M.call(A):S.get(A)),B=(A,S,M)=>S.has(A)?hn("Cannot add the same private member more than once"):S instanceof WeakSet?S.add(A):S.set(A,M),$=(A,S,M,Ie)=>(ar(A,S,"write to private field"),Ie?Ie.call(A,M):S.set(A,M),M),Ne=(A,S,M)=>(ar(A,S,"access private method"),M);(function(){"use strict";var Be,We,ge,at,ut,Re,He,Ce,me,ze,st,ft,ne,pn,Ct,ur,_n;var S=Array.isArray,M=Array.prototype.indexOf,Ie=Array.from,Mt=Object.defineProperty,Le=Object.getOwnPropertyDescriptor,gn=Object.prototype,mn=Array.prototype,wn=Object.getPrototypeOf,sr=Object.isExtensible;const yn=()=>{};function fr(e){for(var t=0;t<e.length;t++)e[t]()}function En(){var e,t,r=new Promise((n,l)=>{e=n,t=l});return{promise:r,resolve:e,reject:t}}const W=2,Dt=4,Nt=8,Fe=16,se=32,ye=64,or=128,z=256,vt=512,F=1024,ee=2048,oe=4096,te=8192,Ee=16384,It=32768,dt=65536,cr=1<<17,bn=1<<18,Lt=1<<19,kn=1<<20,Ft=1<<21,Ot=1<<22,be=1<<23,Ge=Symbol("$state"),xn=Symbol("legacy props"),Ut=new class extends Error{constructor(){super(...arguments);ct(this,"name","StaleReactionError");ct(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Tn(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function Sn(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Pn(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function qn(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function An(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Rn(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Cn(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Mn(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Dn(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Nn(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const In=1,Ln=2,Fn=16,On=1,Un=2,N=Symbol();let Vn=!1;function vr(e){return e===this.v}function jn(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function dr(e){return!jn(e,this.v)}let Qe=!1,ci=!1;function Kn(){Qe=!0}let D=null;function _t(e){D=e}function ke(e,t=!1,r){D={p:D,c:null,e:null,s:e,x:null,l:Qe&&!t?{s:null,u:null,$:[]}:null}}function xe(e){var t=D,r=t.e;if(r!==null){t.e=null;for(var n of r)Cr(n)}return D=t.p,{}}function Oe(){return!Qe||D!==null&&D.l===null}const Yn=new WeakMap;function Bn(e){var t=b;if(t===null)return E.f|=be,e;if((t.f&It)===0){if((t.f&or)===0)throw!t.parent&&e instanceof Error&&_r(e),e;t.b.error(e)}else Vt(e,t)}function Vt(e,t){for(;t!==null;){if((t.f&or)!==0)try{t.b.error(e);return}catch(r){e=r}t=t.parent}throw e instanceof Error&&_r(e),e}function _r(e){const t=Yn.get(e);t&&(Mt(e,"message",{value:t.message}),Mt(e,"stack",{value:t.stack}))}let Xe=[],jt=[];function hr(){var e=Xe;Xe=[],fr(e)}function Wn(){var e=jt;jt=[],fr(e)}function pr(e){Xe.length===0&&queueMicrotask(hr),Xe.push(e)}function Hn(){Xe.length>0&&hr(),jt.length>0&&Wn()}function zn(){for(var e=b.b;e!==null&&!e.has_pending_snippet();)e=e.parent;return e===null&&Tn(),e}function ht(e){var t=W|ee,r=E!==null&&(E.f&W)!==0?E:null;return b===null||r!==null&&(r.f&z)!==0?t|=z:b.f|=Lt,{ctx:D,deps:null,effects:null,equals:vr,f:t,fn:e,reactions:null,rv:0,v:N,wv:0,parent:r??b,ac:null}}function Gn(e,t){let r=b;r===null&&Pn();var n=r.b,l=void 0,i=$e(N),a=null,s=!E;return ol(()=>{try{var u=e()}catch(c){u=Promise.reject(c)}var f=()=>u;l=(a==null?void 0:a.then(f,f))??Promise.resolve(u),a=l;var v=P,_=n.pending;s&&(n.update_pending_count(1),_||v.increment());const d=(c,o=void 0)=>{a=null,_||v.activate(),o?o!==Ut&&(i.f|=be,Et(i,o)):((i.f&be)!==0&&(i.f^=be),Et(i,c)),s&&(n.update_pending_count(-1),_||v.decrement()),yr()};if(l.then(d,c=>d(null,c||"unknown")),v)return()=>{queueMicrotask(()=>v.neuter())}}),new Promise(u=>{function f(v){function _(){v===l?u(i):f(l)}v.then(_,_)}f(l)})}function pt(e){const t=ht(e);return jr(t),t}function gr(e){const t=ht(e);return t.equals=dr,t}function mr(e){var t=e.effects;if(t!==null){e.effects=null;for(var r=0;r<t.length;r+=1)le(t[r])}}function Qn(e){for(var t=e.parent;t!==null;){if((t.f&W)===0)return t;t=t.parent}return null}function Kt(e){var t,r=b;he(Qn(e));try{mr(e),t=Hr(e)}finally{he(r)}return t}function wr(e){var t=Kt(e);if(e.equals(t)||(e.v=t,e.wv=Br()),!Pe)if(ce!==null)ce.set(e,e.v);else{var r=(pe||(e.f&z)!==0)&&e.deps!==null?oe:F;K(e,r)}}function Xn(e,t,r){const n=Oe()?ht:gr;if(t.length===0){r(e.map(n));return}var l=P,i=b,a=Zn(),s=zn();Promise.all(t.map(u=>Gn(u))).then(u=>{l==null||l.activate(),a();try{r([...e.map(n),...u])}catch(f){(i.f&Ee)===0&&Vt(f,i)}l==null||l.deactivate(),yr()}).catch(u=>{s.error(u)})}function Zn(){var e=b,t=E,r=D;return function(){he(e),ae(t),_t(r)}}function yr(){he(null),ae(null),_t(null)}const Ze=new Set;let P=null,gt=null,ce=null,Er=new Set,mt=[];function br(){const e=mt.shift();mt.length>0&&queueMicrotask(br),e()}let Te=[],wt=null,Yt=!1,yt=!1;const Rt=class Rt{constructor(){B(this,ne);ct(this,"current",new Map);B(this,Be,new Map);B(this,We,new Set);B(this,ge,0);B(this,at,null);B(this,ut,!1);B(this,Re,[]);B(this,He,[]);B(this,Ce,[]);B(this,me,[]);B(this,ze,[]);B(this,st,[]);B(this,ft,[]);ct(this,"skipped_effects",new Set)}process(t){var i;Te=[],gt=null;var r=null;if(Ze.size>1){r=new Map,ce=new Map;for(const[a,s]of this.current)r.set(a,{v:a.v,wv:a.wv}),a.v=s;for(const a of Ze)if(a!==this)for(const[s,u]of k(a,Be))r.has(s)||(r.set(s,{v:s.v,wv:s.wv}),s.v=u)}for(const a of t)Ne(this,ne,pn).call(this,a);if(k(this,Re).length===0&&k(this,ge)===0){Ne(this,ne,ur).call(this);var n=k(this,Ce),l=k(this,me);$(this,Ce,[]),$(this,me,[]),$(this,ze,[]),gt=P,P=null,xr(n),xr(l),P===null?P=this:Ze.delete(this),(i=k(this,at))==null||i.resolve()}else Ne(this,ne,Ct).call(this,k(this,Ce)),Ne(this,ne,Ct).call(this,k(this,me)),Ne(this,ne,Ct).call(this,k(this,ze));if(r){for(const[a,{v:s,wv:u}]of r)a.wv<=u&&(a.v=s);ce=null}for(const a of k(this,Re))Ke(a);for(const a of k(this,He))Ke(a);$(this,Re,[]),$(this,He,[])}capture(t,r){k(this,Be).has(t)||k(this,Be).set(t,r),this.current.set(t,t.v)}activate(){P=this}deactivate(){P=null,gt=null;for(const t of Er)if(Er.delete(t),t(),P!==null)break}neuter(){$(this,ut,!0)}flush(){Te.length>0?kr():Ne(this,ne,ur).call(this),P===this&&(k(this,ge)===0&&Ze.delete(this),this.deactivate())}increment(){$(this,ge,k(this,ge)+1)}decrement(){if($(this,ge,k(this,ge)-1),k(this,ge)===0){for(const t of k(this,st))K(t,ee),Ue(t);for(const t of k(this,ft))K(t,oe),Ue(t);$(this,Ce,[]),$(this,me,[]),this.flush()}else this.deactivate()}add_callback(t){k(this,We).add(t)}settled(){return(k(this,at)??$(this,at,En())).promise}static ensure(){if(P===null){const t=P=new Rt;Ze.add(P),yt||Rt.enqueue(()=>{P===t&&t.flush()})}return P}static enqueue(t){mt.length===0&&queueMicrotask(br),mt.unshift(t)}};Be=new WeakMap,We=new WeakMap,ge=new WeakMap,at=new WeakMap,ut=new WeakMap,Re=new WeakMap,He=new WeakMap,Ce=new WeakMap,me=new WeakMap,ze=new WeakMap,st=new WeakMap,ft=new WeakMap,ne=new WeakSet,pn=function(t){var v;t.f^=F;for(var r=t.first;r!==null;){var n=r.f,l=(n&(se|ye))!==0,i=l&&(n&F)!==0,a=i||(n&te)!==0||this.skipped_effects.has(r);if(!a&&r.fn!==null){if(l)r.f^=F;else if((n&Dt)!==0)k(this,me).push(r);else if((n&F)===0)if((n&Ot)!==0){var s=(v=r.b)!=null&&v.pending?k(this,He):k(this,Re);s.push(r)}else St(r)&&((r.f&Fe)!==0&&k(this,ze).push(r),Ke(r));var u=r.first;if(u!==null){r=u;continue}}var f=r.parent;for(r=r.next;r===null&&f!==null;)r=f.next,f=f.parent}},Ct=function(t){for(const r of t)((r.f&ee)!==0?k(this,st):k(this,ft)).push(r),K(r,F);t.length=0},ur=function(){if(!k(this,ut))for(const t of k(this,We))t();k(this,We).clear()};let Je=Rt;function Jn(e){var t=yt;yt=!0;try{for(var r;;){if(Hn(),Te.length===0&&(P==null||P.flush(),Te.length===0))return wt=null,r;kr()}}finally{yt=t}}function kr(){var e=je;Yt=!0;try{var t=0;for(Ur(!0);Te.length>0;){var r=Je.ensure();if(t++>1e3){var n,l;$n()}r.process(Te),ve.clear()}}finally{Yt=!1,Ur(e),wt=null}}function $n(){try{Cn()}catch(e){Vt(e,wt)}}let Se=null;function xr(e){var t=e.length;if(t!==0){for(var r=0;r<t;){var n=e[r++];if((n.f&(Ee|te))===0&&St(n)&&(Se=[],Ke(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null&&n.ac===null?Lr(n):n.fn=null),Se.length>0)){ve.clear();for(const l of Se)Ke(l);Se=[]}}Se=null}}function Ue(e){for(var t=wt=e;t.parent!==null;){t=t.parent;var r=t.f;if(Yt&&t===b&&(r&Fe)!==0)return;if((r&(ye|se))!==0){if((r&F)===0)return;t.f^=F}}Te.push(t)}const ve=new Map;function $e(e,t){var r={f:0,v:e,reactions:null,equals:vr,rv:0,wv:0};return r}function I(e,t){const r=$e(e);return jr(r),r}function el(e,t=!1,r=!0){var l;const n=$e(e);return t||(n.equals=dr),Qe&&r&&D!==null&&D.l!==null&&((l=D.l).s??(l.s=[])).push(n),n}function x(e,t,r=!1){E!==null&&(!ie||(E.f&cr)!==0)&&Oe()&&(E.f&(W|Fe|Ot|cr))!==0&&!(U!=null&&U.includes(e))&&Nn();let n=r?de(t):t;return Et(e,n)}function Et(e,t){if(!e.equals(t)){var r=e.v;Pe?ve.set(e,t):ve.set(e,r),e.v=t;var n=Je.ensure();n.capture(e,r),(e.f&W)!==0&&((e.f&ee)!==0&&Kt(e),K(e,(e.f&z)===0?F:oe)),e.wv=Br(),Tr(e,ee),Oe()&&b!==null&&(b.f&F)!==0&&(b.f&(se|ye))===0&&(Q===null?vl([e]):Q.push(e))}return t}function bt(e,t=1){var r=p(e),n=t===1?r++:r--;return x(e,r),n}function Bt(e){x(e,e.v+1)}function Tr(e,t){var r=e.reactions;if(r!==null)for(var n=Oe(),l=r.length,i=0;i<l;i++){var a=r[i],s=a.f;if(!(!n&&a===b)){var u=(s&ee)===0;u&&K(a,t),(s&W)!==0?Tr(a,oe):u&&((s&Fe)!==0&&Se!==null&&Se.push(a),Ue(a))}}}function de(e){if(typeof e!="object"||e===null||Ge in e)return e;const t=wn(e);if(t!==gn&&t!==mn)return e;var r=new Map,n=S(e),l=I(0),i=qe,a=s=>{if(qe===i)return s();var u=E,f=qe;ae(null),Yr(i);var v=s();return ae(u),Yr(f),v};return n&&r.set("length",I(e.length)),new Proxy(e,{defineProperty(s,u,f){(!("value"in f)||f.configurable===!1||f.enumerable===!1||f.writable===!1)&&Mn();var v=r.get(u);return v===void 0?v=a(()=>{var _=I(f.value);return r.set(u,_),_}):x(v,f.value,!0),!0},deleteProperty(s,u){var f=r.get(u);if(f===void 0){if(u in s){const v=a(()=>I(N));r.set(u,v),Bt(l)}}else x(f,N),Bt(l);return!0},get(s,u,f){var c;if(u===Ge)return e;var v=r.get(u),_=u in s;if(v===void 0&&(!_||(c=Le(s,u))!=null&&c.writable)&&(v=a(()=>{var o=de(_?s[u]:N),h=I(o);return h}),r.set(u,v)),v!==void 0){var d=p(v);return d===N?void 0:d}return Reflect.get(s,u,f)},getOwnPropertyDescriptor(s,u){var f=Reflect.getOwnPropertyDescriptor(s,u);if(f&&"value"in f){var v=r.get(u);v&&(f.value=p(v))}else if(f===void 0){var _=r.get(u),d=_==null?void 0:_.v;if(_!==void 0&&d!==N)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return f},has(s,u){var d;if(u===Ge)return!0;var f=r.get(u),v=f!==void 0&&f.v!==N||Reflect.has(s,u);if(f!==void 0||b!==null&&(!v||(d=Le(s,u))!=null&&d.writable)){f===void 0&&(f=a(()=>{var c=v?de(s[u]):N,o=I(c);return o}),r.set(u,f));var _=p(f);if(_===N)return!1}return v},set(s,u,f,v){var g;var _=r.get(u),d=u in s;if(n&&u==="length")for(var c=f;c<_.v;c+=1){var o=r.get(c+"");o!==void 0?x(o,N):c in s&&(o=a(()=>I(N)),r.set(c+"",o))}if(_===void 0)(!d||(g=Le(s,u))!=null&&g.writable)&&(_=a(()=>I(void 0)),x(_,de(f)),r.set(u,_));else{d=_.v!==N;var h=a(()=>de(f));x(_,h)}var m=Reflect.getOwnPropertyDescriptor(s,u);if(m!=null&&m.set&&m.set.call(v,f),!d){if(n&&typeof u=="string"){var w=r.get("length"),y=Number(u);Number.isInteger(y)&&y>=w.v&&x(w,y+1)}Bt(l)}return!0},ownKeys(s){p(l);var u=Reflect.ownKeys(s).filter(_=>{var d=r.get(_);return d===void 0||d.v!==N});for(var[f,v]of r)v.v!==N&&!(f in s)&&u.push(f);return u},setPrototypeOf(){Dn()}})}var Wt,Sr,Pr,qr;function tl(){if(Wt===void 0){Wt=window,Sr=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,r=Text.prototype;Pr=Le(t,"firstChild").get,qr=Le(t,"nextSibling").get,sr(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),sr(r)&&(r.__t=void 0)}}function et(e=""){return document.createTextNode(e)}function _e(e){return Pr.call(e)}function kt(e){return qr.call(e)}function O(e,t){return _e(e)}function re(e,t){{var r=_e(e);return r instanceof Comment&&r.data===""?kt(r):r}}function G(e,t=1,r=!1){let n=e;for(;t--;)n=kt(n);return n}function rl(e){e.textContent=""}function Ar(){return!1}let Rr=!1;function nl(){Rr||(Rr=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const r of e.target.elements)(t=r.__on_r)==null||t.call(r)})},{capture:!0}))}function xt(e){var t=E,r=b;ae(null),he(null);try{return e()}finally{ae(t),he(r)}}function ll(e,t,r,n=r){e.addEventListener(t,()=>xt(r));const l=e.__on_r;l?e.__on_r=()=>{l(),n(!0)}:e.__on_r=()=>n(!0),nl()}function il(e){b===null&&E===null&&Rn(),E!==null&&(E.f&z)!==0&&b===null&&An(),Pe&&qn()}function al(e,t){var r=t.last;r===null?t.last=t.first=e:(r.next=e,e.prev=r,t.last=e)}function fe(e,t,r,n=!0){var l=b;l!==null&&(l.f&te)!==0&&(e|=te);var i={ctx:D,deps:null,nodes_start:null,nodes_end:null,f:e|ee,first:null,fn:t,last:null,next:null,parent:l,b:l&&l.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{Ke(i),i.f|=It}catch(u){throw le(i),u}else t!==null&&Ue(i);var a=r&&i.deps===null&&i.first===null&&i.nodes_start===null&&i.teardown===null&&(i.f&Lt)===0;if(!a&&n&&(l!==null&&al(i,l),E!==null&&(E.f&W)!==0&&(e&ye)===0)){var s=E;(s.effects??(s.effects=[])).push(i)}return i}function ul(e){const t=fe(Nt,null,!1);return K(t,F),t.teardown=e,t}function Tt(e){il();var t=b.f,r=!E&&(t&se)!==0&&(t&It)===0;if(r){var n=D;(n.e??(n.e=[])).push(e)}else return Cr(e)}function Cr(e){return fe(Dt|kn,e,!1)}function sl(e){Je.ensure();const t=fe(ye,e,!0);return(r={})=>new Promise(n=>{r.outro?zt(t,()=>{le(t),n(void 0)}):(le(t),n(void 0))})}function fl(e){return fe(Dt,e,!1)}function ol(e){return fe(Ot|Lt,e,!0)}function Mr(e,t=0){return fe(Nt|t,e,!0)}function tt(e,t=[],r=[]){Xn(t,r,n=>{fe(Nt,()=>e(...n.map(p)),!0)})}function Ht(e,t=0){var r=fe(Fe|t,e,!0);return r}function Ve(e,t=!0){return fe(se,e,!0,t)}function Dr(e){var t=e.teardown;if(t!==null){const r=Pe,n=E;Vr(!0),ae(null);try{t.call(null)}finally{Vr(r),ae(n)}}}function Nr(e,t=!1){var r=e.first;for(e.first=e.last=null;r!==null;){const l=r.ac;l!==null&&xt(()=>{l.abort(Ut)});var n=r.next;(r.f&ye)!==0?r.parent=null:le(r,t),r=n}}function cl(e){for(var t=e.first;t!==null;){var r=t.next;(t.f&se)===0&&le(t),t=r}}function le(e,t=!0){var r=!1;(t||(e.f&bn)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(Ir(e.nodes_start,e.nodes_end),r=!0),Nr(e,t&&!r),Pt(e,0),K(e,Ee);var n=e.transitions;if(n!==null)for(const i of n)i.stop();Dr(e);var l=e.parent;l!==null&&l.first!==null&&Lr(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function Ir(e,t){for(;e!==null;){var r=e===t?null:kt(e);e.remove(),e=r}}function Lr(e){var t=e.parent,r=e.prev,n=e.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),t!==null&&(t.first===e&&(t.first=n),t.last===e&&(t.last=r))}function zt(e,t){var r=[];Gt(e,r,!0),Fr(r,()=>{le(e),t&&t()})}function Fr(e,t){var r=e.length;if(r>0){var n=()=>--r||t();for(var l of e)l.out(n)}else t()}function Gt(e,t,r){if((e.f&te)===0){if(e.f^=te,e.transitions!==null)for(const a of e.transitions)(a.is_global||r)&&t.push(a);for(var n=e.first;n!==null;){var l=n.next,i=(n.f&dt)!==0||(n.f&se)!==0;Gt(n,t,i?r:!1),n=l}}}function Qt(e){Or(e,!0)}function Or(e,t){if((e.f&te)!==0){e.f^=te,(e.f&F)===0&&(K(e,ee),Ue(e));for(var r=e.first;r!==null;){var n=r.next,l=(r.f&dt)!==0||(r.f&se)!==0;Or(r,l?t:!1),r=n}if(e.transitions!==null)for(const i of e.transitions)(i.is_global||t)&&i.in()}}let je=!1;function Ur(e){je=e}let Pe=!1;function Vr(e){Pe=e}let E=null,ie=!1;function ae(e){E=e}let b=null;function he(e){b=e}let U=null;function jr(e){E!==null&&(U===null?U=[e]:U.push(e))}let V=null,H=0,Q=null;function vl(e){Q=e}let Kr=1,rt=0,qe=rt;function Yr(e){qe=e}let pe=!1;function Br(){return++Kr}function St(e){var _;var t=e.f;if((t&ee)!==0)return!0;if((t&oe)!==0){var r=e.deps,n=(t&z)!==0;if(r!==null){var l,i,a=(t&vt)!==0,s=n&&b!==null&&!pe,u=r.length;if((a||s)&&(b===null||(b.f&Ee)===0)){var f=e,v=f.parent;for(l=0;l<u;l++)i=r[l],(a||!((_=i==null?void 0:i.reactions)!=null&&_.includes(f)))&&(i.reactions??(i.reactions=[])).push(f);a&&(f.f^=vt),s&&v!==null&&(v.f&z)===0&&(f.f^=z)}for(l=0;l<u;l++)if(i=r[l],St(i)&&wr(i),i.wv>e.wv)return!0}(!n||b!==null&&!pe)&&K(e,F)}return!1}function Wr(e,t,r=!0){var n=e.reactions;if(n!==null&&!(U!=null&&U.includes(e)))for(var l=0;l<n.length;l++){var i=n[l];(i.f&W)!==0?Wr(i,t,!1):t===i&&(r?K(i,ee):(i.f&F)!==0&&K(i,oe),Ue(i))}}function Hr(e){var h;var t=V,r=H,n=Q,l=E,i=pe,a=U,s=D,u=ie,f=qe,v=e.f;V=null,H=0,Q=null,pe=(v&z)!==0&&(ie||!je||E===null),E=(v&(se|ye))===0?e:null,U=null,_t(e.ctx),ie=!1,qe=++rt,e.ac!==null&&(xt(()=>{e.ac.abort(Ut)}),e.ac=null);try{e.f|=Ft;var _=e.fn,d=_(),c=e.deps;if(V!==null){var o;if(Pt(e,H),c!==null&&H>0)for(c.length=H+V.length,o=0;o<V.length;o++)c[H+o]=V[o];else e.deps=c=V;if(!pe||(v&W)!==0&&e.reactions!==null)for(o=H;o<c.length;o++)((h=c[o]).reactions??(h.reactions=[])).push(e)}else c!==null&&H<c.length&&(Pt(e,H),c.length=H);if(Oe()&&Q!==null&&!ie&&c!==null&&(e.f&(W|oe|ee))===0)for(o=0;o<Q.length;o++)Wr(Q[o],e);return l!==null&&l!==e&&(rt++,Q!==null&&(n===null?n=Q:n.push(...Q))),(e.f&be)!==0&&(e.f^=be),d}catch(m){return Bn(m)}finally{e.f^=Ft,V=t,H=r,Q=n,E=l,pe=i,U=a,_t(s),ie=u,qe=f}}function dl(e,t){let r=t.reactions;if(r!==null){var n=M.call(r,e);if(n!==-1){var l=r.length-1;l===0?r=t.reactions=null:(r[n]=r[l],r.pop())}}r===null&&(t.f&W)!==0&&(V===null||!V.includes(t))&&(K(t,oe),(t.f&(z|vt))===0&&(t.f^=vt),mr(t),Pt(t,0))}function Pt(e,t){var r=e.deps;if(r!==null)for(var n=t;n<r.length;n++)dl(e,r[n])}function Ke(e){var t=e.f;if((t&Ee)===0){K(e,F);var r=b,n=je;b=e,je=!0;try{(t&Fe)!==0?cl(e):Nr(e),Dr(e);var l=Hr(e);e.teardown=typeof l=="function"?l:null,e.wv=Kr;var i}finally{je=n,b=r}}}async function zr(){await Promise.resolve(),Jn()}function p(e){var t=e.f,r=(t&W)!==0;if(E!==null&&!ie){var n=b!==null&&(b.f&Ee)!==0;if(!n&&!(U!=null&&U.includes(e))){var l=E.deps;if((E.f&Ft)!==0)e.rv<rt&&(e.rv=rt,V===null&&l!==null&&l[H]===e?H++:V===null?V=[e]:(!pe||!V.includes(e))&&V.push(e));else{(E.deps??(E.deps=[])).push(e);var i=e.reactions;i===null?e.reactions=[E]:i.includes(E)||i.push(E)}}}else if(r&&e.deps===null&&e.effects===null){var a=e,s=a.parent;s!==null&&(s.f&z)===0&&(a.f^=z)}if(Pe){if(ve.has(e))return ve.get(e);if(r){a=e;var u=a.v;return((a.f&F)===0&&a.reactions!==null||Gr(a))&&(u=Kt(a)),ve.set(a,u),u}}else if(r){if(a=e,ce!=null&&ce.has(a))return ce.get(a);St(a)&&wr(a)}if((e.f&be)!==0)throw e.v;return e.v}function Gr(e){if(e.v===N)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(ve.has(t)||(t.f&W)!==0&&Gr(t))return!0;return!1}function Xt(e){var t=ie;try{return ie=!0,e()}finally{ie=t}}const _l=-7169;function K(e,t){e.f=e.f&_l|t}const hl=["touchstart","touchmove"];function pl(e){return hl.includes(e)}const Qr=new Set,Zt=new Set;function gl(e,t,r,n={}){function l(i){if(n.capture||nt.call(t,i),!i.cancelBubble)return xt(()=>r==null?void 0:r.call(this,i))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?pr(()=>{t.addEventListener(e,l,n)}):t.addEventListener(e,l,n),l}function Xr(e,t,r,n,l){var i={capture:n,passive:l},a=gl(e,t,r,i);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&ul(()=>{t.removeEventListener(e,a,i)})}function Jt(e){for(var t=0;t<e.length;t++)Qr.add(e[t]);for(var r of Zt)r(e)}let Zr=null;function nt(e){var y;var t=this,r=t.ownerDocument,n=e.type,l=((y=e.composedPath)==null?void 0:y.call(e))||[],i=l[0]||e.target;Zr=e;var a=0,s=Zr===e&&e.__root;if(s){var u=l.indexOf(s);if(u!==-1&&(t===document||t===window)){e.__root=t;return}var f=l.indexOf(t);if(f===-1)return;u<=f&&(a=u)}if(i=l[a]||e.target,i!==t){Mt(e,"currentTarget",{configurable:!0,get(){return i||r}});var v=E,_=b;ae(null),he(null);try{for(var d,c=[];i!==null;){var o=i.assignedSlot||i.parentNode||i.host||null;try{var h=i["__"+n];if(h!=null&&(!i.disabled||e.target===i))if(S(h)){var[m,...w]=h;m.apply(i,[e,...w])}else h.call(i,e)}catch(g){d?c.push(g):d=g}if(e.cancelBubble||o===t||o===null)break;i=o}if(d){for(let g of c)queueMicrotask(()=>{throw g});throw d}}finally{e.__root=t,delete e.currentTarget,ae(v),he(_)}}}function Jr(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function lt(e,t){var r=b;r.nodes_start===null&&(r.nodes_start=e,r.nodes_end=t)}function L(e,t){var r=(t&On)!==0,n=(t&Un)!==0,l,i=!e.startsWith("<!>");return()=>{l===void 0&&(l=Jr(i?e:"<!>"+e),r||(l=_e(l)));var a=n||Sr?document.importNode(l,!0):l.cloneNode(!0);if(r){var s=_e(a),u=a.lastChild;lt(s,u)}else lt(a,a);return a}}function ml(e=""){{var t=et(e+"");return lt(t,t),t}}function Ae(){var e=document.createDocumentFragment(),t=document.createComment(""),r=et();return e.append(t,r),lt(t,r),e}function q(e,t){e!==null&&e.before(t)}function $t(e,t){var r=t==null?"":typeof t=="object"?t+"":t;r!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=r,e.nodeValue=r+"")}function wl(e,t){return yl(e,t)}const Ye=new Map;function yl(e,{target:t,anchor:r,props:n={},events:l,context:i,intro:a=!0}){tl();var s=new Set,u=_=>{for(var d=0;d<_.length;d++){var c=_[d];if(!s.has(c)){s.add(c);var o=pl(c);t.addEventListener(c,nt,{passive:o});var h=Ye.get(c);h===void 0?(document.addEventListener(c,nt,{passive:o}),Ye.set(c,1)):Ye.set(c,h+1)}}};u(Ie(Qr)),Zt.add(u);var f=void 0,v=sl(()=>{var _=r??t.appendChild(et());return Ve(()=>{if(i){ke({});var d=D;d.c=i}l&&(n.$$events=l),f=e(_,n)||{},i&&xe()}),()=>{var o;for(var d of s){t.removeEventListener(d,nt);var c=Ye.get(d);--c===0?(document.removeEventListener(d,nt),Ye.delete(d)):Ye.set(d,c)}Zt.delete(u),_!==r&&((o=_.parentNode)==null||o.removeChild(_))}});return El.set(f,v),f}let El=new WeakMap;function X(e,t,r=!1){var n=e,l=null,i=null,a=N,s=r?dt:0,u=!1;const f=(c,o=!0)=>{u=!0,d(o,c)};var v=null;function _(){v!==null&&(v.lastChild.remove(),n.before(v),v=null);var c=a?l:i,o=a?i:l;c&&Qt(c),o&&zt(o,()=>{a?i=null:l=null})}const d=(c,o)=>{if(a!==(a=c)){var h=Ar(),m=n;if(h&&(v=document.createDocumentFragment(),v.append(m=et())),a?l??(l=o&&Ve(()=>o(m))):i??(i=o&&Ve(()=>o(m))),h){var w=P,y=a?l:i,g=a?i:l;y&&w.skipped_effects.delete(y),g&&w.skipped_effects.add(g),w.add_callback(_)}else _()}};Ht(()=>{u=!1,t(f),u||d(null,null)},s)}function $r(e,t){return t}function bl(e,t,r){for(var n=e.items,l=[],i=t.length,a=0;a<i;a++)Gt(t[a].e,l,!0);var s=i>0&&l.length===0&&r!==null;if(s){var u=r.parentNode;rl(u),u.append(r),n.clear(),ue(e,t[0].prev,t[i-1].next)}Fr(l,()=>{for(var f=0;f<i;f++){var v=t[f];s||(n.delete(v.k),ue(e,v.prev,v.next)),le(v.e,!s)}})}function en(e,t,r,n,l,i=null){var a=e,s={flags:t,items:new Map,first:null},u=null,f=!1,v=new Map,_=gr(()=>{var h=r();return S(h)?h:h==null?[]:Ie(h)}),d,c;function o(){kl(c,d,s,v,a,l,t,n,r),i!==null&&(d.length===0?u?Qt(u):u=Ve(()=>i(a)):u!==null&&zt(u,()=>{u=null}))}Ht(()=>{c??(c=b),d=p(_);var h=d.length;if(!(f&&h===0)){f=h===0;var m,w,y,g;if(Ar()){var T=new Set,C=P;for(w=0;w<h;w+=1){y=d[w],g=n(y,w);var j=s.items.get(g)??v.get(g);j?tn(j,y,w):(m=rn(null,s,null,null,y,g,w,l,t,r,!0),v.set(g,m)),T.add(g)}for(const[Z,Y]of s.items)T.has(Z)||C.skipped_effects.add(Y.e);C.add_callback(o)}else o();p(_)}})}function kl(e,t,r,n,l,i,a,s,u){var f=t.length,v=r.items,_=r.first,d=_,c,o=null,h=[],m=[],w,y,g,T;for(T=0;T<f;T+=1){if(w=t[T],y=s(w,T),g=v.get(y),g===void 0){var C=n.get(y);if(C!==void 0){n.delete(y),v.set(y,C);var j=o?o.next:d;ue(r,o,C),ue(r,C,j),er(C,j,l),o=C}else{var Z=d?d.e.nodes_start:l;o=rn(Z,r,o,o===null?r.first:o.next,w,y,T,i,a,u)}v.set(y,o),h=[],m=[],d=o.next;continue}if(tn(g,w,T),(g.e.f&te)!==0&&Qt(g.e),g!==d){if(c!==void 0&&c.has(g)){if(h.length<m.length){var Y=m[0],R;o=Y.prev;var J=h[0],we=h[h.length-1];for(R=0;R<h.length;R+=1)er(h[R],Y,l);for(R=0;R<m.length;R+=1)c.delete(m[R]);ue(r,J.prev,we.next),ue(r,o,J),ue(r,we,Y),d=Y,o=we,T-=1,h=[],m=[]}else c.delete(g),er(g,d,l),ue(r,g.prev,g.next),ue(r,g,o===null?r.first:o.next),ue(r,o,g),o=g;continue}for(h=[],m=[];d!==null&&d.k!==y;)(d.e.f&te)===0&&(c??(c=new Set)).add(d),m.push(d),d=d.next;if(d===null)continue;g=d}h.push(g),o=g,d=g.next}if(d!==null||c!==void 0){for(var Me=c===void 0?[]:Ie(c);d!==null;)(d.e.f&te)===0&&Me.push(d),d=d.next;var De=Me.length;if(De>0){var ot=null;bl(r,Me,ot)}}e.first=r.first&&r.first.e,e.last=o&&o.e;for(var si of n.values())le(si.e);n.clear()}function tn(e,t,r,n){Et(e.v,t),e.i=r}function rn(e,t,r,n,l,i,a,s,u,f,v){var _=(u&In)!==0,d=(u&Fn)===0,c=_?d?el(l,!1,!1):$e(l):l,o=(u&Ln)===0?a:$e(a),h={i:o,v:c,k:i,a:null,e:null,prev:r,next:n};try{if(e===null){var m=document.createDocumentFragment();m.append(e=et())}return h.e=Ve(()=>s(e,c,o,f),Vn),h.e.prev=r&&r.e,h.e.next=n&&n.e,r===null?v||(t.first=h):(r.next=h,r.e.next=h.e),n!==null&&(n.prev=h,n.e.prev=h.e),h}finally{}}function er(e,t,r){for(var n=e.next?e.next.e.nodes_start:r,l=t?t.e.nodes_start:r,i=e.e.nodes_start;i!==null&&i!==n;){var a=kt(i);l.before(i),i=a}}function ue(e,t,r){t===null?e.first=r:(t.next=r,t.e.next=r&&r.e),r!==null&&(r.prev=t,r.e.prev=t&&t.e)}function qt(e,t,r=!1,n=!1,l=!1){var i=e,a="";tt(()=>{var s=b;if(a!==(a=t()??"")&&(s.nodes_start!==null&&(Ir(s.nodes_start,s.nodes_end),s.nodes_start=s.nodes_end=null),a!=="")){var u=a+"";r?u=`<svg>${u}</svg>`:n&&(u=`<math>${u}</math>`);var f=Jr(u);if((r||n)&&(f=_e(f)),lt(_e(f),f.lastChild),r||n)for(;_e(f);)i.before(_e(f));else i.before(f)}})}function it(e,t,...r){var n=e,l=yn,i;Ht(()=>{l!==(l=t())&&(i&&(le(i),i=null),i=Ve(()=>l(n,...r)))},dt)}const nn=[...` 	\n\\r\\f\xA0\\v\\uFEFF`];function xl(e,t,r){var n=""+e;if(r){for(var l in r)if(r[l])n=n?n+" "+l:l;else if(n.length)for(var i=l.length,a=0;(a=n.indexOf(l,a))>=0;){var s=a+i;(a===0||nn.includes(n[a-1]))&&(s===n.length||nn.includes(n[s]))?n=(a===0?"":n.substring(0,a))+n.substring(s+1):a=s}}return n===""?null:n}function ln(e,t=!1){var r=t?" !important;":";",n="";for(var l in e){var i=e[l];i!=null&&i!==""&&(n+=" "+l+": "+i+r)}return n}function Tl(e,t){if(t){var r="",n,l;return Array.isArray(t)?(n=t[0],l=t[1]):n=t,n&&(r+=ln(n)),l&&(r+=ln(l,!0)),r=r.trim(),r===""?null:r}return String(e)}function Sl(e,t,r,n,l,i){var a=e.__className;if(a!==r||a===void 0){var s=xl(r,n,i);s==null?e.removeAttribute("class"):e.className=s,e.__className=r}else if(i&&l!==i)for(var u in i){var f=!!i[u];(l==null||f!==!!l[u])&&e.classList.toggle(u,f)}return i}function tr(e,t={},r,n){for(var l in r){var i=r[l];t[l]!==i&&(r[l]==null?e.style.removeProperty(l):e.style.setProperty(l,i,n))}}function Pl(e,t,r,n){var l=e.__style;if(l!==t){var i=Tl(t,n);i==null?e.removeAttribute("style"):e.style.cssText=i,e.__style=t}else n&&(Array.isArray(n)?(tr(e,r==null?void 0:r[0],n[0]),tr(e,r==null?void 0:r[1],n[1],"important")):tr(e,r,n));return n}function ql(e,t,r=t){var n=Oe(),l=new WeakSet;ll(e,"input",i=>{var a=i?e.defaultValue:e.value;if(a=rr(e)?nr(a):a,r(a),P!==null&&l.add(P),n&&a!==(a=t())){var s=e.selectionStart,u=e.selectionEnd;e.value=a??"",u!==null&&(e.selectionStart=s,e.selectionEnd=Math.min(u,e.value.length))}}),Xt(t)==null&&e.value&&(r(rr(e)?nr(e.value):e.value),P!==null&&l.add(P)),Mr(()=>{var i=t();if(e===document.activeElement){var a=gt??P;if(l.has(a))return}rr(e)&&i===nr(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function rr(e){var t=e.type;return t==="number"||t==="range"}function nr(e){return e===""?null:+e}function an(e,t){return e===t||(e==null?void 0:e[Ge])===t}function Al(e={},t,r,n){return fl(()=>{var l,i;return Mr(()=>{l=i,i=[],Xt(()=>{e!==r(...i)&&(t(e,...i),l&&an(r(...l),e)&&t(null,...l))})}),()=>{pr(()=>{i&&an(r(...i),e)&&t(null,...i)})}}),e}let At=!1;function Rl(e){var t=At;try{return At=!1,[e(),At]}finally{At=t}}function lr(e,t,r,n){var m;var l=n,i=!0,a=()=>(i&&(i=!1,l=n),l),s;{var u=Ge in e||xn in e;s=((m=Le(e,t))==null?void 0:m.set)??(u&&t in e?w=>e[t]=w:void 0)}var f,v=!1;[f,v]=Rl(()=>e[t]);var _;if(_=()=>{var w=e[t];return w===void 0?a():(i=!0,w)},s){var d=e.$$legacy;return(function(w,y){return arguments.length>0?((!y||d||v)&&s(y?_():w),w):_()})}var c=!1,o=ht(()=>(c=!1,_()));p(o);var h=b;return(function(w,y){if(arguments.length>0){const g=y?p(o):de(w);return x(o,g),c=!0,l!==void 0&&(l=g),w}return Pe&&c||(h.f&Ee)!==0?o.v:p(o)})}function Cl(e){D===null&&Sn(),Qe&&D.l!==null?Ml(D).m.push(e):Tt(()=>{const t=Xt(e);if(typeof t=="function")return t})}function Ml(e){var t=e.l;return t.u??(t.u={a:[],b:[],m:[]})}const Dl="5";typeof window<"u"&&((_n=window.__svelte??(window.__svelte={})).v??(_n.v=new Set)).add(Dl);function un(e,t){let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>{e(...n)},t)}}var Nl=e=>e.stopPropagation(),Il=L(\'<dialog class="sb-modal-box svelte-umhpev"><div class="sb-header"><label for="mini-editor">Search</label> <div class="sb-mini-editor"><input id="mini-editor" placeholder="Search with Silversearch" autocomplete="off" class="svelte-umhpev"/></div></div> <div class="sb-help-text"><!></div> <div class="sb-result-list" style="max-height: 80vh;"><!></div></dialog>\');function sn(e,t){ke(t,!0);let r=lr(t,"query"),n;Tt(()=>{n.showModal()});function l(){syscall("editor.hidePanel","modal")}var i=Il();Xr("click",Wt,l);var a=O(i);a.__click=[Nl],a.__keydown=function(...c){var o;(o=t.onkeydown)==null||o.apply(this,c)};var s=G(O(a),2),u=O(s),f=G(a,2),v=O(f);it(v,()=>t.helpText);var _=G(f,2),d=O(_);it(d,()=>t.resultList),Al(i,c=>n=c,()=>n),Xr("cancel",i,c=>{c.preventDefault(),syscall("editor.hidePanel","modal")}),ql(u,r),q(e,i),xe()}Jt(["click","keydown"]),Kn();var Ll=L(`<div class="silversearch-help svelte-1n3mku8"><p class="svelte-1n3mku8">Add the following to your query to refine the search:</p> <ul class="svelte-1n3mku8"><li>Use <code>path:&quot;Library&quot;</code> to restrict your results\n            to paths which include &quot;Library&quot;</li> <li>Use <code>ext:pdf,jpg</code> or <code>ext:png</code>, or\n            a plain <code>.png</code> to restrict your search to certain filetypes</li> <li>Use <code>&quot;exact expressions&quot;</code> in quotes to further filter\n            the results returned by the query</li> <li>Use <code>-apple -pie</code> to exclude notes containing the words\n            &quot;apple&quot; and &quot;pie&quot;</li></ul></div>`);function fn(e){var t=Ll();q(e,t)}function Fl(e){return e.replace(/[.*+?^${}()|[\\]\\\\]/g,"\\\\$&")}const on=/(<br>|&lt;|&gt;|&quot;|&#039;)/g;function ir(e,t){const r="silversearch-highlight";if(!t.length)return e;try{return e.split(on).map(n=>n.match(on)?n:n.replace(new RegExp(`(${t.map(l=>Fl(l.match)).join("|")})`,"giu"),`<span class="${r}">$1</span>`)).join("")}catch(n){return console.error("[Silversearch] Error in highlightText()",n),e}}var Ol=L(\'<span class="silversearch-title svelte-nz7epw"><!></span>\'),Ul=L(\'<span class="silversearch-info svelte-nz7epw"><!></span>\'),Vl=L(\'<div class="sb-name svelte-nz7epw"><!> <!></div>\'),jl=L(\'<div><!> <div class="sb-description svelte-nz7epw"><!></div></div>\');function cn(e,t){var r=jl();let n;r.__click=function(...u){var f;(f=t.onclick)==null||f.apply(this,u)},r.__mousemove=function(...u){var f;(f=t.onmousemove)==null||f.apply(this,u)};var l=O(r);{var i=u=>{var f=Vl(),v=O(f);{var _=o=>{var h=Ol(),m=O(h);it(m,()=>t.title),q(o,h)};X(v,o=>{t.title&&o(_)})}var d=G(v,2);{var c=o=>{var h=Ul(),m=O(h);it(m,()=>t.info),q(o,h)};X(d,o=>{t.info&&o(c)})}q(u,f)};X(l,u=>{(t.title||t.info)&&u(i)})}var a=G(l,2),s=O(a);it(s,()=>t.description),tt(u=>n=Sl(r,1,"sb-option",null,n,u),[()=>({"silversearch-selected":t.selected})]),q(e,r)}Jt(["click","mousemove"]);function Kl(e,t){ke(t,!0),cn(e,{get onclick(){return t.onclick},get onmousemove(){return t.onmousemove},get selected(){return t.selected},description:n=>{var l=Ae(),i=re(l);qt(i,()=>ir(t.excerpt.excerpt,t.matches)),q(n,l)}}),xe()}var Yl=L(\'<p class="silversearch-apology svelte-10gbmf8">Silversearch found <code>0</code> results for your query</p>\');function vn(e){var t=Yl();q(e,t)}var Bl=L(\'<div class="container svelte-qcdftr"><div class="bar svelte-qcdftr"></div></div>\');function Wl(e,t){var r=Bl(),n=O(r);let l;tt(i=>l=Pl(n,"",l,i),[()=>({width:t.progress===null?"30%":`${t.progress}%`,animation:t.progress===null?"slide 1s linear infinite":"none"})]),q(e,r)}var Hl=L(\'<p class="svelte-uxdu0l">Indexed <code> </code> out of <code> </code> documents</p>\'),zl=L(\'<p class="svelte-uxdu0l">Loading ...</p>\'),Gl=L(\'<div class="silversearch-apology svelte-uxdu0l"><!> <!></div>\');function dn(e,t){ke(t,!0);let r=I(null),n=pt(()=>p(r)?p(r).done/p(r).all*100:null);Cl(()=>{const f=setInterval(async()=>{const v=await syscall("clientStore.get","silversearch-progress");v&&x(r,v,!0)},50);return()=>clearInterval(f)});var l=Gl(),i=O(l);Wl(i,{get progress(){return p(n)}});var a=G(i,2);{var s=f=>{var v=Hl(),_=G(O(v)),d=O(_),c=G(_,2),o=O(c);tt(()=>{$t(d,p(r).done),$t(o,p(r).all)}),q(f,v)},u=f=>{var v=zl();q(f,v)};X(a,f=>{p(r)!==null?f(s):f(u,!1)})}q(e,l),xe()}var Ql=L("Press <code>Ctrl-Enter</code> to open in new Tab. Use <code>Tab</code> to switch scope.",1),Xl=L("<!> <!>",1);function Zl(e,t){ke(t,!0);let r=lr(t,"query"),n=I(null),l=I(!1),i=I(0);Tt(()=>{r()?a():(x(n,null),x(l,!1))});const a=un(u,0);let s=null;async function u(){x(l,!0),s&&(s.reject("canceled"),s=null),s=Promise.withResolvers();try{x(n,(await Promise.race([syscall("silversearch.search",r(),{singleFilePath:t.currentPath,silent:!0}),s.promise]))[0],!0),s=null,x(i,0),_(),x(l,!1)}catch{}}async function f(d){if(!p(n))return;const c=p(n).excerpts[p(i)].offset;await syscall("editor.navigate",`${p(n).name}@${c}`,!1,d),await syscall("editor.hidePanel","modal")}function v(d){var c;if(d.key==="ArrowUp")bt(i,-1);else if(d.key==="ArrowDown")bt(i);else if(d.key==="Enter")f(d.ctrlKey);else return;d.preventDefault(),x(i,Math.max(0,Math.min((((c=p(n))==null?void 0:c.excerpts.length)??0)-1,p(i))),!0),_()}async function _(){await zr();const d=document.querySelector(".silversearch-selected");d&&d.scrollIntoView({block:"nearest"})}sn(e,{onkeydown:v,get query(){return r()},set query(o){r(o)},helpText:o=>{var h=Ql();q(o,h)},resultList:o=>{var h=Xl(),m=re(h);en(m,17,()=>{var T;return((T=p(n))==null?void 0:T.excerpts)??[]},$r,(T,C,j)=>{const Z=pt(()=>j===p(i));{let Y=pt(()=>{var R;return((R=p(n))==null?void 0:R.matches)??[]});Kl(T,{get excerpt(){return p(C)},get matches(){return p(Y)},get selected(){return p(Z)},onclick:({ctrlKey:R})=>f(R),onmousemove:()=>x(i,j,!0)})}});var w=G(m,2);{var y=T=>{vn(T)},g=T=>{var C=Ae(),j=re(C);{var Z=R=>{fn(R)},Y=R=>{var J=Ae(),we=re(J);{var Me=De=>{dn(De,{})};X(we,De=>{!p(n)&&p(l)&&De(Me)},!0)}q(R,J)};X(j,R=>{!p(n)&&!p(l)?R(Z):R(Y,!1)},!0)}q(T,C)};X(w,T=>{!p(n)&&!p(l)&&r()?T(y):T(g,!1)})}q(o,h)},$$slots:{helpText:!0,resultList:!0}}),xe()}function Jl(e,t){for(const r of e)if(r.type==="range"&&r.from<=t&&t<=r.to)return r.tail;return""}function $l(e,t){ke(t,!0),cn(e,{get onmousemove(){return t.onmousemove},get onclick(){return t.onclick},get selected(){return t.selected},title:i=>{var a=Ae(),s=re(a);qt(s,()=>ir(t.result.name,t.result.matchesName)),q(i,a)},info:i=>{var a=ml();tt(()=>$t(a,`${t.result.matches.length??""} Matches`)),q(i,a)},description:i=>{var a=Ae(),s=re(a);qt(s,()=>ir(t.result.excerpts[0].excerpt,t.result.matches)),q(i,a)}}),xe()}var ei=L("Use <code>Tab</code> to switch scope.",1),ti=L("Press <code>Ctrl-Enter</code> to open in new Tab and <code>Alt-Enter</code> to insert a link. <!>",1),ri=L("<!> <!>",1);function ni(e,t){ke(t,!0);let r=lr(t,"query"),n=I(de([])),l=I(!1),i=I(0);Tt(()=>{r()?a():(x(n,[],!0),x(l,!1))});const a=un(u,0);let s=null;async function u(){x(l,!0),s&&(s.reject("canceled"),s=null),s=Promise.withResolvers();try{x(n,await Promise.race([syscall("silversearch.search",r(),{silent:!0}),s.promise]),!0),s=null,x(i,0),d(),x(l,!1)}catch{}}async function f(c){var w,y;if(p(n).length==0)return;const o=p(n)[p(i)],h=((y=(w=o.matches)==null?void 0:w[0])==null?void 0:y.offset)??0;let m=`@${h}`;o.navigationMap&&(m=Jl(o.navigationMap,h)),await syscall("editor.navigate",`${o.name}${m}`,!1,c),await syscall("editor.hidePanel","modal")}async function v(){const o=`[[${p(n)[p(i)].name}]]`;await syscall("editor.insertAtCursor",o),await syscall("editor.hidePanel","modal")}function _(c){if(c.key==="ArrowUp")bt(i,-1);else if(c.key==="ArrowDown")bt(i);else if(c.key==="Enter")c.altKey?v():f(c.ctrlKey);else return;c.preventDefault(),x(i,Math.max(0,Math.min(p(n).length-1,p(i))),!0),d()}async function d(){await zr();const c=document.querySelector(".silversearch-selected");c&&c.scrollIntoView({block:"nearest"})}sn(e,{onkeydown:_,get query(){return r()},set query(h){r(h)},helpText:h=>{var m=ti(),w=G(re(m),5);{var y=g=>{var T=ei();q(g,T)};X(w,g=>{t.isDocumentEditor||g(y)})}q(h,m)},resultList:h=>{var m=ri(),w=re(m);en(w,17,()=>p(n),$r,(C,j,Z)=>{const Y=pt(()=>Z===p(i));$l(C,{get result(){return p(j)},get selected(){return p(Y)},onclick:({ctrlKey:R})=>f(R),onmousemove:()=>x(i,Z,!0)})});var y=G(w,2);{var g=C=>{vn(C)},T=C=>{var j=Ae(),Z=re(j);{var Y=J=>{fn(J)},R=J=>{var we=Ae(),Me=re(we);{var De=ot=>{dn(ot,{})};X(Me,ot=>{!p(n).length&&p(l)&&ot(De)},!0)}q(J,we)};X(Z,J=>{!p(n).length&&!p(l)?J(Y):J(R,!1)},!0)}q(C,j)};X(y,C=>{!p(n).length&&!p(l)&&r()?C(g):C(T,!1)})}q(h,m)},$$slots:{helpText:!0,resultList:!0}}),xe()}function li(e,t,r){e.stopPropagation(),e.key==="Tab"&&(t.isDocumentEditor||(x(r,!p(r)),e.preventDefault()))}var ii=L("<!> <div><!></div>",1);function ai(e,t){let r=I(de(t.defaultQuery)),n=I(!0);var l=ii(),i=re(l);qt(i,()=>t.customStyles);var a=G(i,2);a.__keydown=[li,t,n];var s=O(a);{var u=v=>{ni(v,{get isDocumentEditor(){return t.isDocumentEditor},get query(){return p(r)},set query(_){x(r,_,!0)}})},f=v=>{Zl(v,{get currentPath(){return t.currentPath},get query(){return p(r)},set query(_){x(r,_,!0)}})};X(s,v=>{p(n)?v(u):v(f,!1)})}q(e,l)}Jt(["keydown"]);async function ui(){const e=syscall("editor.getCurrentPath"),t=syscall("editor.getCurrentEditor"),r=syscall("editor.getUiOption","customStyles");await Promise.race([new Promise(n=>setTimeout(n,75)),new Promise(n=>{const l=document.querySelector("link#stylesheet");l&&(l.onload=n)})]),wl(ai,{target:document.querySelector("#container"),props:{defaultQuery:globalThis.DEFAULT_QUERY??"",currentPath:await e,isDocumentEditor:await t!=="page",customStyles:await r}})}ui()})();\n';var Sn=`<style>html,body{background:none!important;--silversearch-progress-bar-color: var(--ui-accent-text-color)}*{font-family:var(--ui-font)}code{font-family:monospace}.silversearch-highlight{background-color:color-mix(in srgb,var(--editor-highlight-background-color),50% transparent)}dialog.svelte-umhpev{outline:none}#mini-editor.svelte-umhpev{caret-color:var(--editor-caret-color);outline:none;border:none;padding:2px 0 0 3px;line-height:1.4;width:100%;background:none;font-family:var(--ui-font);font-size:1em;color:inherit}.silversearch-help.svelte-1n3mku8{padding:8px;line-height:1.5;color:var(--modal-help-color)}.silversearch-help.svelte-1n3mku8 p:where(.svelte-1n3mku8){margin:0}.silversearch-help.svelte-1n3mku8 ul:where(.svelte-1n3mku8){margin:0;list-style-position:inside;padding-left:15px}.sb-description.svelte-nz7epw{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3;line-clamp:3;overflow:hidden}.sb-name.svelte-nz7epw{display:flex;white-space:nowrap;align-items:baseline}.silversearch-info.svelte-nz7epw{font-size:.8rem;margin-left:1ch;color:var(--modal-description-color)}.silversearch-title.svelte-nz7epw{text-overflow:ellipsis;overflow:hidden}.silversearch-selected{background-color:var(--editor-selection-background-color)}.silversearch-apology.svelte-10gbmf8{text-align:center;padding:5px}.container.svelte-qcdftr{background:var(--progress-background-color);position:relative;width:300px;height:8px;margin:1rem;border-radius:4px;overflow:hidden}.bar.svelte-qcdftr{background:var(--silversearch-progress-bar-color);position:absolute;height:100%;left:0;border-radius:4px;transition:width .3s ease}@keyframes slide{0%{left:-30%}to{left:100%}}.silversearch-apology.svelte-uxdu0l{display:flex;flex-direction:column;align-items:center;padding:1em}.silversearch-apology.svelte-uxdu0l p:where(.svelte-uxdu0l){margin:0}</style>
<link id="stylesheet" rel="stylesheet" href="/.client/main.css"/>
<div id="container"></div>`;var Pr="ENTRIES",En="KEYS",Mn="VALUES",P="",ue=class{constructor(e,t){let s=e._tree,r=Array.from(s.keys());this.set=e,this._type=t,this._path=r.length>0?[{node:s,keys:r}]:[]}next(){let e=this.dive();return this.backtrack(),e}dive(){if(this._path.length===0)return{done:!0,value:void 0};let{node:e,keys:t}=X(this._path);if(X(t)===P)return{done:!1,value:this.result()};let s=e.get(X(t));return this._path.push({node:s,keys:Array.from(s.keys())}),this.dive()}backtrack(){if(this._path.length===0)return;let e=X(this._path).keys;e.pop(),!(e.length>0)&&(this._path.pop(),this.backtrack())}key(){return this.set._prefix+this._path.map(({keys:e})=>X(e)).filter(e=>e!==P).join("")}value(){return X(this._path).node.get(P)}result(){switch(this._type){case Mn:return this.value();case En:return this.key();default:return[this.key(),this.value()]}}[Symbol.iterator](){return this}},X=n=>n[n.length-1],Er=(n,e,t)=>{let s=new Map;if(e===void 0)return s;let r=e.length+1,u=r+t,o=new Uint8Array(u*r).fill(t+1);for(let i=0;i<r;++i)o[i]=i;for(let i=1;i<u;++i)o[i*r]=i;return vn(n,e,t,s,o,1,r,""),s},vn=(n,e,t,s,r,u,o,i)=>{let p=u*o;e:for(let I of n.keys())if(I===P){let l=r[p-1];l<=t&&s.set(i,[n.get(I),l])}else{let l=u;for(let d=0;d<I.length;++d,++l){let f=I[d],T=o*l,k=T-o,y=r[T],h=Math.max(0,l-t-1),x=Math.min(o-1,l+t);for(let g=h;g<x;++g){let w=f!==e[g],A=r[k+g]+ +w,B=r[k+g+1]+1,M=r[T+g]+1,D=r[T+g+1]=Math.min(A,B,M);D<y&&(y=D)}if(y>t)continue e}vn(n.get(I),e,t,s,r,l,o,i+I)}},oe=class n{constructor(e=new Map,t=""){this._size=void 0,this._tree=e,this._prefix=t}atPrefix(e){if(!e.startsWith(this._prefix))throw new Error("Mismatched prefix");let[t,s]=ye(this._tree,e.slice(this._prefix.length));if(t===void 0){let[r,u]=$e(s);for(let o of r.keys())if(o!==P&&o.startsWith(u)){let i=new Map;return i.set(o.slice(u.length),r.get(o)),new n(i,e)}}return new n(t,e)}clear(){this._size=void 0,this._tree.clear()}delete(e){return this._size=void 0,Mr(this._tree,e)}entries(){return new ue(this,Pr)}forEach(e){for(let[t,s]of this)e(t,s,this)}fuzzyGet(e,t){return Er(this._tree,e,t)}get(e){let t=Le(this._tree,e);return t!==void 0?t.get(P):void 0}has(e){let t=Le(this._tree,e);return t!==void 0&&t.has(P)}keys(){return new ue(this,En)}set(e,t){if(typeof e!="string")throw new Error("key must be a string");return this._size=void 0,Ce(this._tree,e).set(P,t),this}get size(){if(this._size)return this._size;this._size=0;let e=this.entries();for(;!e.next().done;)this._size+=1;return this._size}update(e,t){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;let s=Ce(this._tree,e);return s.set(P,t(s.get(P))),this}fetch(e,t){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;let s=Ce(this._tree,e),r=s.get(P);return r===void 0&&s.set(P,r=t()),r}values(){return new ue(this,Mn)}[Symbol.iterator](){return this.entries()}static from(e){let t=new n;for(let[s,r]of e)t.set(s,r);return t}static fromObject(e){return n.from(Object.entries(e))}},ye=(n,e,t=[])=>{if(e.length===0||n==null)return[n,t];for(let s of n.keys())if(s!==P&&e.startsWith(s))return t.push([n,s]),ye(n.get(s),e.slice(s.length),t);return t.push([n,e]),ye(void 0,"",t)},Le=(n,e)=>{if(e.length===0||n==null)return n;for(let t of n.keys())if(t!==P&&e.startsWith(t))return Le(n.get(t),e.slice(t.length))},Ce=(n,e)=>{let t=e.length;e:for(let s=0;n&&s<t;){for(let u of n.keys())if(u!==P&&e[s]===u[0]){let o=Math.min(t-s,u.length),i=1;for(;i<o&&e[s+i]===u[i];)++i;let p=n.get(u);if(i===u.length)n=p;else{let I=new Map;I.set(u.slice(i),p),n.set(e.slice(s,s+i),I),n.delete(u),n=I}s+=i;continue e}let r=new Map;return n.set(e.slice(s),r),r}return n},Mr=(n,e)=>{let[t,s]=ye(n,e);if(t!==void 0){if(t.delete(P),t.size===0)Rn(s);else if(t.size===1){let[r,u]=t.entries().next().value;jn(s,r,u)}}},Rn=n=>{if(n.length===0)return;let[e,t]=$e(n);if(e.delete(t),e.size===0)Rn(n.slice(0,-1));else if(e.size===1){let[s,r]=e.entries().next().value;s!==P&&jn(n.slice(0,-1),s,r)}},jn=(n,e,t)=>{if(n.length===0)return;let[s,r]=$e(n);s.set(r+e,t),s.delete(r)},$e=n=>n[n.length-1],ze="or",_n="and",vr="and_not",Q=class n{constructor(e){if(e?.fields==null)throw new Error('MiniSearch: option "fields" must be provided');let t=e.autoVacuum==null||e.autoVacuum===!0?Ne:e.autoVacuum;this._options={...Ve,...e,autoVacuum:t,searchOptions:{...An,...e.searchOptions||{}},autoSuggestOptions:{...Dr,...e.autoSuggestOptions||{}}},this._index=new oe,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this._dirtCount=0,this._currentVacuum=null,this._enqueuedVacuum=null,this._enqueuedVacuumConditions=Ke,this.addFields(this._options.fields)}add(e){let{extractField:t,tokenize:s,processTerm:r,fields:u,idField:o}=this._options,i=t(e,o);if(i==null)throw new Error(`MiniSearch: document does not have ID field "${o}"`);if(this._idToShortId.has(i))throw new Error(`MiniSearch: duplicate ID ${i}`);let p=this.addDocumentId(i);this.saveStoredFields(p,e);for(let I of u){let l=t(e,I);if(l==null)continue;let d=s(l.toString(),I),f=this._fieldIds[I],T=new Set(d).size;this.addFieldLength(p,f,this._documentCount-1,T);for(let k of d){let y=r(k,I);if(Array.isArray(y))for(let h of y)this.addTerm(f,p,h);else y&&this.addTerm(f,p,y)}}}addAll(e){for(let t of e)this.add(t)}addAllAsync(e,t={}){let{chunkSize:s=10}=t,r={chunk:[],promise:Promise.resolve()},{chunk:u,promise:o}=e.reduce(({chunk:i,promise:p},I,l)=>(i.push(I),(l+1)%s===0?{chunk:[],promise:p.then(()=>new Promise(d=>setTimeout(d,0))).then(()=>this.addAll(i))}:{chunk:i,promise:p}),r);return o.then(()=>this.addAll(u))}remove(e){let{tokenize:t,processTerm:s,extractField:r,fields:u,idField:o}=this._options,i=r(e,o);if(i==null)throw new Error(`MiniSearch: document does not have ID field "${o}"`);let p=this._idToShortId.get(i);if(p==null)throw new Error(`MiniSearch: cannot remove document with ID ${i}: it is not in the index`);for(let I of u){let l=r(e,I);if(l==null)continue;let d=t(l.toString(),I),f=this._fieldIds[I],T=new Set(d).size;this.removeFieldLength(p,f,this._documentCount,T);for(let k of d){let y=s(k,I);if(Array.isArray(y))for(let h of y)this.removeTerm(f,p,h);else y&&this.removeTerm(f,p,y)}}this._storedFields.delete(p),this._documentIds.delete(p),this._idToShortId.delete(i),this._fieldLength.delete(p),this._documentCount-=1}removeAll(e){if(e)for(let t of e)this.remove(t);else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new oe,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}}discard(e){let t=this._idToShortId.get(e);if(t==null)throw new Error(`MiniSearch: cannot discard document with ID ${e}: it is not in the index`);this._idToShortId.delete(e),this._documentIds.delete(t),this._storedFields.delete(t),(this._fieldLength.get(t)||[]).forEach((s,r)=>{this.removeFieldLength(t,r,this._documentCount,s)}),this._fieldLength.delete(t),this._documentCount-=1,this._dirtCount+=1,this.maybeAutoVacuum()}maybeAutoVacuum(){if(this._options.autoVacuum===!1)return;let{minDirtFactor:e,minDirtCount:t,batchSize:s,batchWait:r}=this._options.autoVacuum;this.conditionalVacuum({batchSize:s,batchWait:r},{minDirtCount:t,minDirtFactor:e})}discardAll(e){let t=this._options.autoVacuum;try{this._options.autoVacuum=!1;for(let s of e)this.discard(s)}finally{this._options.autoVacuum=t}this.maybeAutoVacuum()}replace(e){let{idField:t,extractField:s}=this._options,r=s(e,t);this.discard(r),this.add(e)}vacuum(e={}){return this.conditionalVacuum(e)}conditionalVacuum(e,t){return this._currentVacuum?(this._enqueuedVacuumConditions=this._enqueuedVacuumConditions&&t,this._enqueuedVacuum!=null?this._enqueuedVacuum:(this._enqueuedVacuum=this._currentVacuum.then(()=>{let s=this._enqueuedVacuumConditions;return this._enqueuedVacuumConditions=Ke,this.performVacuuming(e,s)}),this._enqueuedVacuum)):this.vacuumConditionsMet(t)===!1?Promise.resolve():(this._currentVacuum=this.performVacuuming(e),this._currentVacuum)}async performVacuuming(e,t){let s=this._dirtCount;if(this.vacuumConditionsMet(t)){let r=e.batchSize||Fe.batchSize,u=e.batchWait||Fe.batchWait,o=1;for(let[i,p]of this._index){for(let[I,l]of p)for(let[d]of l)this._documentIds.has(d)||(l.size<=1?p.delete(I):l.delete(d));this._index.get(i).size===0&&this._index.delete(i),o%r===0&&await new Promise(I=>setTimeout(I,u)),o+=1}this._dirtCount-=s}await null,this._currentVacuum=this._enqueuedVacuum,this._enqueuedVacuum=null}vacuumConditionsMet(e){if(e==null)return!0;let{minDirtCount:t,minDirtFactor:s}=e;return t=t||Ne.minDirtCount,s=s||Ne.minDirtFactor,this.dirtCount>=t&&this.dirtFactor>=s}get isVacuuming(){return this._currentVacuum!=null}get dirtCount(){return this._dirtCount}get dirtFactor(){return this._dirtCount/(1+this._documentCount+this._dirtCount)}has(e){return this._idToShortId.has(e)}getStoredFields(e){let t=this._idToShortId.get(e);if(t!=null)return this._storedFields.get(t)}search(e,t={}){let{searchOptions:s}=this._options,r={...s,...t},u=this.executeQuery(e,t),o=[];for(let[i,{score:p,terms:I,match:l}]of u){let d=I.length||1,f={id:this._documentIds.get(i),score:p*d,terms:Object.keys(l),queryTerms:I,match:l};Object.assign(f,this._storedFields.get(i)),(r.filter==null||r.filter(f))&&o.push(f)}return e===n.wildcard&&r.boostDocument==null||o.sort(bn),o}autoSuggest(e,t={}){t={...this._options.autoSuggestOptions,...t};let s=new Map;for(let{score:u,terms:o}of this.search(e,t)){let i=o.join(" "),p=s.get(i);p!=null?(p.score+=u,p.count+=1):s.set(i,{score:u,terms:o,count:1})}let r=[];for(let[u,{score:o,terms:i,count:p}]of s)r.push({suggestion:u,terms:i,score:o/p});return r.sort(bn),r}get documentCount(){return this._documentCount}get termCount(){return this._index.size}static loadJSON(e,t){if(t==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJS(JSON.parse(e),t)}static async loadJSONAsync(e,t){if(t==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJSAsync(JSON.parse(e),t)}static getDefault(e){if(Ve.hasOwnProperty(e))return We(Ve,e);throw new Error(`MiniSearch: unknown option "${e}"`)}static loadJS(e,t){let{index:s,documentIds:r,fieldLength:u,storedFields:o,serializationVersion:i}=e,p=this.instantiateMiniSearch(e,t);p._documentIds=le(r),p._fieldLength=le(u),p._storedFields=le(o);for(let[I,l]of p._documentIds)p._idToShortId.set(l,I);for(let[I,l]of s){let d=new Map;for(let f of Object.keys(l)){let T=l[f];i===1&&(T=T.ds),d.set(parseInt(f,10),le(T))}p._index.set(I,d)}return p}static async loadJSAsync(e,t){let{index:s,documentIds:r,fieldLength:u,storedFields:o,serializationVersion:i}=e,p=this.instantiateMiniSearch(e,t);p._documentIds=await Te(r),p._fieldLength=await Te(u),p._storedFields=await Te(o);for(let[l,d]of p._documentIds)p._idToShortId.set(d,l);let I=0;for(let[l,d]of s){let f=new Map;for(let T of Object.keys(d)){let k=d[T];i===1&&(k=k.ds),f.set(parseInt(T,10),await Te(k))}++I%1e3===0&&await qn(0),p._index.set(l,f)}return p}static instantiateMiniSearch(e,t){let{documentCount:s,nextId:r,fieldIds:u,averageFieldLength:o,dirtCount:i,serializationVersion:p}=e;if(p!==1&&p!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");let I=new n(t);return I._documentCount=s,I._nextId=r,I._idToShortId=new Map,I._fieldIds=u,I._avgFieldLength=o,I._dirtCount=i||0,I._index=new oe,I}executeQuery(e,t={}){if(e===n.wildcard)return this.executeWildcardQuery(t);if(typeof e!="string"){let f={...t,...e,queries:void 0},T=e.queries.map(k=>this.executeQuery(k,f));return this.combineResults(T,f.combineWith)}let{tokenize:s,processTerm:r,searchOptions:u}=this._options,o={tokenize:s,processTerm:r,...u,...t},{tokenize:i,processTerm:p}=o,d=i(e).flatMap(f=>p(f)).filter(f=>!!f).map(qr(o)).map(f=>this.executeQuerySpec(f,o));return this.combineResults(d,o.combineWith)}executeQuerySpec(e,t){let s={...this._options.searchOptions,...t},r=(s.fields||this._options.fields).reduce((y,h)=>({...y,[h]:We(s.boost,h)||1}),{}),{boostDocument:u,weights:o,maxFuzzy:i,bm25:p}=s,{fuzzy:I,prefix:l}={...An.weights,...o},d=this._index.get(e.term),f=this.termResults(e.term,e.term,1,e.termBoost,d,r,u,p),T,k;if(e.prefix&&(T=this._index.atPrefix(e.term)),e.fuzzy){let y=e.fuzzy===!0?.2:e.fuzzy,h=y<1?Math.min(i,Math.round(e.term.length*y)):y;h&&(k=this._index.fuzzyGet(e.term,h))}if(T)for(let[y,h]of T){let x=y.length-e.term.length;if(!x)continue;k?.delete(y);let g=l*y.length/(y.length+.3*x);this.termResults(e.term,y,g,e.termBoost,h,r,u,p,f)}if(k)for(let y of k.keys()){let[h,x]=k.get(y);if(!x)continue;let g=I*y.length/(y.length+x);this.termResults(e.term,y,g,e.termBoost,h,r,u,p,f)}return f}executeWildcardQuery(e){let t=new Map,s={...this._options.searchOptions,...e};for(let[r,u]of this._documentIds){let o=s.boostDocument?s.boostDocument(u,"",this._storedFields.get(r)):1;t.set(r,{score:o,terms:[],match:{}})}return t}combineResults(e,t=ze){if(e.length===0)return new Map;let s=t.toLowerCase(),r=Rr[s];if(!r)throw new Error(`Invalid combination operator: ${t}`);return e.reduce(r)||new Map}toJSON(){let e=[];for(let[t,s]of this._index){let r={};for(let[u,o]of s)r[u]=Object.fromEntries(o);e.push([t,r])}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),dirtCount:this._dirtCount,index:e,serializationVersion:2}}termResults(e,t,s,r,u,o,i,p,I=new Map){if(u==null)return I;for(let l of Object.keys(o)){let d=o[l],f=this._fieldIds[l],T=u.get(f);if(T==null)continue;let k=T.size,y=this._avgFieldLength[f];for(let h of T.keys()){if(!this._documentIds.has(h)){this.removeTerm(f,h,t),k-=1;continue}let x=i?i(this._documentIds.get(h),t,this._storedFields.get(h)):1;if(!x)continue;let g=T.get(h),w=this._fieldLength.get(h)[f],A=_r(g,k,this._documentCount,w,y,p),B=s*r*d*x*A,M=I.get(h);if(M){M.score+=B,Cr(M.terms,e);let D=We(M.match,t);D?D.push(l):M.match[t]=[l]}else I.set(h,{score:B,terms:[e],match:{[t]:[l]}})}}return I}addTerm(e,t,s){let r=this._index.fetch(s,Pn),u=r.get(e);if(u==null)u=new Map,u.set(t,1),r.set(e,u);else{let o=u.get(t);u.set(t,(o||0)+1)}}removeTerm(e,t,s){if(!this._index.has(s)){this.warnDocumentChanged(t,e,s);return}let r=this._index.fetch(s,Pn),u=r.get(e);u==null||u.get(t)==null?this.warnDocumentChanged(t,e,s):u.get(t)<=1?u.size<=1?r.delete(e):u.delete(t):u.set(t,u.get(t)-1),this._index.get(s).size===0&&this._index.delete(s)}warnDocumentChanged(e,t,s){for(let r of Object.keys(this._fieldIds))if(this._fieldIds[r]===t){this._options.logger("warn",`MiniSearch: document with ID ${this._documentIds.get(e)} has changed before removal: term "${s}" was not present in field "${r}". Removing a document after it has changed can corrupt the index!`,"version_conflict");return}}addDocumentId(e){let t=this._nextId;return this._idToShortId.set(e,t),this._documentIds.set(t,e),this._documentCount+=1,this._nextId+=1,t}addFields(e){for(let t=0;t<e.length;t++)this._fieldIds[e[t]]=t}addFieldLength(e,t,s,r){let u=this._fieldLength.get(e);u==null&&this._fieldLength.set(e,u=[]),u[t]=r;let i=(this._avgFieldLength[t]||0)*s+r;this._avgFieldLength[t]=i/(s+1)}removeFieldLength(e,t,s,r){if(s===1){this._avgFieldLength[t]=0;return}let u=this._avgFieldLength[t]*s-r;this._avgFieldLength[t]=u/(s-1)}saveStoredFields(e,t){let{storeFields:s,extractField:r}=this._options;if(s==null||s.length===0)return;let u=this._storedFields.get(e);u==null&&this._storedFields.set(e,u={});for(let o of s){let i=r(t,o);i!==void 0&&(u[o]=i)}}};Q.wildcard=Symbol("*");var We=(n,e)=>Object.prototype.hasOwnProperty.call(n,e)?n[e]:void 0,Rr={[ze]:(n,e)=>{for(let t of e.keys()){let s=n.get(t);if(s==null)n.set(t,e.get(t));else{let{score:r,terms:u,match:o}=e.get(t);s.score=s.score+r,s.match=Object.assign(s.match,o),Bn(s.terms,u)}}return n},[_n]:(n,e)=>{let t=new Map;for(let s of e.keys()){let r=n.get(s);if(r==null)continue;let{score:u,terms:o,match:i}=e.get(s);Bn(r.terms,o),t.set(s,{score:r.score+u,terms:r.terms,match:Object.assign(r.match,i)})}return t},[vr]:(n,e)=>{for(let t of e.keys())n.delete(t);return n}},jr={k:1.2,b:.7,d:.5},_r=(n,e,t,s,r,u)=>{let{k:o,b:i,d:p}=u;return Math.log(1+(t-e+.5)/(e+.5))*(p+n*(o+1)/(n+o*(1-i+i*s/r)))},qr=n=>(e,t,s)=>{let r=typeof n.fuzzy=="function"?n.fuzzy(e,t,s):n.fuzzy||!1,u=typeof n.prefix=="function"?n.prefix(e,t,s):n.prefix===!0,o=typeof n.boostTerm=="function"?n.boostTerm(e,t,s):1;return{term:e,fuzzy:r,prefix:u,termBoost:o}},Ve={idField:"id",extractField:(n,e)=>n[e],tokenize:n=>n.split(Wr),processTerm:n=>n.toLowerCase(),fields:void 0,searchOptions:void 0,storeFields:[],logger:(n,e)=>{typeof console?.[n]=="function"&&console[n](e)},autoVacuum:!0},An={combineWith:ze,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375},bm25:jr},Dr={combineWith:_n,prefix:(n,e,t)=>e===t.length-1},Fe={batchSize:1e3,batchWait:10},Ke={minDirtFactor:.1,minDirtCount:20},Ne={...Fe,...Ke},Cr=(n,e)=>{n.includes(e)||n.push(e)},Bn=(n,e)=>{for(let t of e)n.includes(t)||n.push(t)},bn=({score:n},{score:e})=>e-n,Pn=()=>new Map,le=n=>{let e=new Map;for(let t of Object.keys(n))e.set(parseInt(t,10),n[t]);return e},Te=async n=>{let e=new Map,t=0;for(let s of Object.keys(n))e.set(parseInt(s,10),n[s]),++t%1e3===0&&await qn(0);return e},qn=n=>new Promise(e=>setTimeout(e,n)),Wr=/[\n\r\p{Z}\p{P}]+/u;var Ue;function F(n){return{lang:n?.lang??Ue?.lang,message:n?.message,abortEarly:n?.abortEarly??Ue?.abortEarly,abortPipeEarly:n?.abortPipeEarly??Ue?.abortPipeEarly}}var Vr;function Dn(n){return Vr?.get(n)}var Nr;function Cn(n){return Nr?.get(n)}var Lr;function Wn(n,e){return Lr?.get(n)?.get(e)}function b(n){let e=typeof n;return e==="string"?`"${n}"`:e==="number"||e==="bigint"||e==="boolean"?`${n}`:e==="object"||e==="function"?(n&&Object.getPrototypeOf(n)?.constructor?.name)??"null":e}function a(n,e,t,s,r){let u=r&&"input"in r?r.input:t.value,o=r?.expected??n.expects??null,i=r?.received??b(u),p={kind:n.kind,type:n.type,input:u,expected:o,received:i,message:`Invalid ${e}: ${o?`Expected ${o} but r`:"R"}eceived ${i}`,requirement:n.requirement,path:r?.path,issues:r?.issues,lang:s.lang,abortEarly:s.abortEarly,abortPipeEarly:s.abortPipeEarly},I=n.kind==="schema",l=r?.message??n.message??Wn(n.reference,p.lang)??(I?Cn(p.lang):null)??s.message??Dn(p.lang);l!==void 0&&(p.message=typeof l=="function"?l(p):l),I&&(t.typed=!1),t.issues?t.issues.push(p):t.issues=[p]}function m(n){return{version:1,vendor:"valibot",validate(e){return n["~run"]({value:e},F())}}}function G(n,e){return Object.hasOwn(n,e)&&e!=="__proto__"&&e!=="prototype"&&e!=="constructor"}function j(n,e){let t=[...new Set(n)];return t.length>1?`(${t.join(` ${e} `)})`:t[0]??"never"}function he(n){if(n.path){let e="";for(let t of n.path)if(typeof t.key=="string"||typeof t.key=="number")e?e+=`.${t.key}`:e+=t.key;else return null;return e}return null}var _=class extends Error{issues;constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function ie(n){return{kind:"transformation",type:"args",reference:ie,async:!1,schema:n,"~run"(e,t){let s=e.value;return e.value=(...r)=>{let u=this.schema["~run"]({value:r},t);if(u.issues)throw new _(u.issues);return s(...u.value)},e}}}function Xe(n){return{kind:"validation",type:"non_empty",reference:Xe,async:!1,expects:"!0",message:n,"~run"(e,t){return e.typed&&e.value.length===0&&a(this,"length",e,t,{received:"0"}),e}}}function xe(n){return{kind:"transformation",type:"returns",reference:xe,async:!1,schema:n,"~run"(e,t){let s=e.value;return e.value=(...r)=>{let u=this.schema["~run"]({value:s(...r)},t);if(u.issues)throw new _(u.issues);return u.value},e}}}function Qe(n){return{kind:"transformation",type:"returns",reference:Qe,async:!1,schema:n,"~run"(e,t){let s=e.value;return e.value=async(...r)=>{let u=await this.schema["~run"]({value:await s(...r)},t);if(u.issues)throw new _(u.issues);return u.value},e}}}function q(n,e,t){return typeof n.fallback=="function"?n.fallback(e,t):n.fallback}function Vn(n){let e={};for(let t of n)if(t.path){let s=he(t);s?(e.nested||(e.nested={}),e.nested[s]?e.nested[s].push(t.message):e.nested[s]=[t.message]):e.other?e.other.push(t.message):e.other=[t.message]}else e.root?e.root.push(t.message):e.root=[t.message];return e}function S(n,e,t){return typeof n.default=="function"?n.default(e,t):n.default}function K(n,e){return{kind:"schema",type:"array",reference:K,expects:"Array",async:!1,item:n,message:e,get"~standard"(){return m(this)},"~run"(t,s){let r=t.value;if(Array.isArray(r)){t.typed=!0,t.value=[];for(let u=0;u<r.length;u++){let o=r[u],i=this.item["~run"]({value:o},s);if(i.issues){let p={type:"array",origin:"value",input:r,key:u,value:o};for(let I of i.issues)I.path?I.path.unshift(p):I.path=[p],t.issues?.push(I);if(t.issues||(t.issues=i.issues),s.abortEarly){t.typed=!1;break}}i.typed||(t.typed=!1),t.value.push(i.value)}}else a(this,"type",t,s);return t}}}function N(n){return{kind:"schema",type:"boolean",reference:N,expects:"boolean",async:!1,message:n,get"~standard"(){return m(this)},"~run"(e,t){return typeof e.value=="boolean"?e.typed=!0:a(this,"type",e,t),e}}}function Ze(n,e){let t=[];for(let s in n)(`${+s}`!==s||typeof n[s]!="string"||!Object.is(n[n[s]],+s))&&t.push(n[s]);return{kind:"schema",type:"enum",reference:Ze,expects:j(t.map(b),"|"),async:!1,enum:n,options:t,message:e,get"~standard"(){return m(this)},"~run"(s,r){return this.options.includes(s.value)?s.typed=!0:a(this,"type",s,r),s}}}function ae(n){return{kind:"schema",type:"function",reference:ae,expects:"Function",async:!1,message:n,get"~standard"(){return m(this)},"~run"(e,t){return typeof e.value=="function"?e.typed=!0:a(this,"type",e,t),e}}}function Ye(n){return{kind:"schema",type:"lazy",reference:Ye,expects:"unknown",async:!1,getter:n,get"~standard"(){return m(this)},"~run"(e,t){return this.getter(e.value)["~run"](e,t)}}}function en(n,e){return{kind:"schema",type:"literal",reference:en,expects:b(n),async:!1,literal:n,message:e,get"~standard"(){return m(this)},"~run"(t,s){return t.value===this.literal?t.typed=!0:a(this,"type",t,s),t}}}function nn(n){return{kind:"schema",type:"null",reference:nn,expects:"null",async:!1,message:n,get"~standard"(){return m(this)},"~run"(e,t){return e.value===null?e.typed=!0:a(this,"type",e,t),e}}}function C(n){return{kind:"schema",type:"number",reference:C,expects:"number",async:!1,message:n,get"~standard"(){return m(this)},"~run"(e,t){return typeof e.value=="number"&&!isNaN(e.value)?e.typed=!0:a(this,"type",e,t),e}}}function tn(n,e){return{kind:"schema",type:"object",reference:tn,expects:"Object",async:!1,entries:n,message:e,get"~standard"(){return m(this)},"~run"(t,s){let r=t.value;if(r&&typeof r=="object"){t.typed=!0,t.value={};for(let u in this.entries){let o=this.entries[u];if(u in r||(o.type==="exact_optional"||o.type==="optional"||o.type==="nullish")&&o.default!==void 0){let i=u in r?r[u]:S(o),p=o["~run"]({value:i},s);if(p.issues){let I={type:"object",origin:"value",input:r,key:u,value:i};for(let l of p.issues)l.path?l.path.unshift(I):l.path=[I],t.issues?.push(l);if(t.issues||(t.issues=p.issues),s.abortEarly){t.typed=!1;break}}p.typed||(t.typed=!1),t.value[u]=p.value}else if(o.fallback!==void 0)t.value[u]=q(o);else if(o.type!=="exact_optional"&&o.type!=="optional"&&o.type!=="nullish"&&(a(this,"key",t,s,{input:void 0,expected:`"${u}"`,path:[{type:"object",origin:"key",input:r,key:u,value:r[u]}]}),s.abortEarly))break}}else a(this,"type",t,s);return t}}}function O(n,e){return{kind:"schema",type:"optional",reference:O,expects:`(${n.expects} | undefined)`,async:!1,wrapped:n,default:e,get"~standard"(){return m(this)},"~run"(t,s){return t.value===void 0&&(this.default!==void 0&&(t.value=S(this,t,s)),t.value===void 0)?(t.typed=!0,t):this.wrapped["~run"](t,s)}}}function Z(n,e){return{kind:"schema",type:"picklist",reference:Z,expects:j(n.map(b),"|"),async:!1,options:n,message:e,get"~standard"(){return m(this)},"~run"(t,s){return this.options.includes(t.value)?t.typed=!0:a(this,"type",t,s),t}}}function Y(n,e,t){return{kind:"schema",type:"record",reference:Y,expects:"Object",async:!1,key:n,value:e,message:t,get"~standard"(){return m(this)},"~run"(s,r){let u=s.value;if(u&&typeof u=="object"){s.typed=!0,s.value={};for(let o in u)if(G(u,o)){let i=u[o],p=this.key["~run"]({value:o},r);if(p.issues){let l={type:"object",origin:"key",input:u,key:o,value:i};for(let d of p.issues)d.path=[l],s.issues?.push(d);if(s.issues||(s.issues=p.issues),r.abortEarly){s.typed=!1;break}}let I=this.value["~run"]({value:i},r);if(I.issues){let l={type:"object",origin:"value",input:u,key:o,value:i};for(let d of I.issues)d.path?d.path.unshift(l):d.path=[l],s.issues?.push(d);if(s.issues||(s.issues=I.issues),r.abortEarly){s.typed=!1;break}}(!p.typed||!I.typed)&&(s.typed=!1),p.typed&&(s.value[p.value]=I.value)}}else a(this,"type",s,r);return s}}}function $(n,e){return{kind:"schema",type:"strict_object",reference:$,expects:"Object",async:!1,entries:n,message:e,get"~standard"(){return m(this)},"~run"(t,s){let r=t.value;if(r&&typeof r=="object"){t.typed=!0,t.value={};for(let u in this.entries){let o=this.entries[u];if(u in r||(o.type==="exact_optional"||o.type==="optional"||o.type==="nullish")&&o.default!==void 0){let i=u in r?r[u]:S(o),p=o["~run"]({value:i},s);if(p.issues){let I={type:"object",origin:"value",input:r,key:u,value:i};for(let l of p.issues)l.path?l.path.unshift(I):l.path=[I],t.issues?.push(l);if(t.issues||(t.issues=p.issues),s.abortEarly){t.typed=!1;break}}p.typed||(t.typed=!1),t.value[u]=p.value}else if(o.fallback!==void 0)t.value[u]=q(o);else if(o.type!=="exact_optional"&&o.type!=="optional"&&o.type!=="nullish"&&(a(this,"key",t,s,{input:void 0,expected:`"${u}"`,path:[{type:"object",origin:"key",input:r,key:u,value:r[u]}]}),s.abortEarly))break}if(!t.issues||!s.abortEarly){for(let u in r)if(!(u in this.entries)){a(this,"key",t,s,{input:u,expected:"never",path:[{type:"object",origin:"key",input:r,key:u,value:r[u]}]});break}}}else a(this,"type",t,s);return t}}}function v(n){return{kind:"schema",type:"string",reference:v,expects:"string",async:!1,message:n,get"~standard"(){return m(this)},"~run"(e,t){return typeof e.value=="string"?e.typed=!0:a(this,"type",e,t),e}}}function pe(n,e){return{kind:"schema",type:"tuple",reference:pe,expects:"Array",async:!1,items:n,message:e,get"~standard"(){return m(this)},"~run"(t,s){let r=t.value;if(Array.isArray(r)){t.typed=!0,t.value=[];for(let u=0;u<this.items.length;u++){let o=r[u],i=this.items[u]["~run"]({value:o},s);if(i.issues){let p={type:"array",origin:"value",input:r,key:u,value:o};for(let I of i.issues)I.path?I.path.unshift(p):I.path=[p],t.issues?.push(I);if(t.issues||(t.issues=i.issues),s.abortEarly){t.typed=!1;break}}i.typed||(t.typed=!1),t.value.push(i.value)}}else a(this,"type",t,s);return t}}}function ge(n){let e;if(n)for(let t of n)e?e.push(...t.issues):e=t.issues;return e}function sn(n,e){return{kind:"schema",type:"union",reference:sn,expects:j(n.map(t=>t.expects),"|"),async:!1,options:n,message:e,get"~standard"(){return m(this)},"~run"(t,s){let r,u,o;for(let i of this.options){let p=i["~run"]({value:t.value},s);if(p.typed)if(p.issues)u?u.push(p):u=[p];else{r=p;break}else o?o.push(p):o=[p]}if(r)return r;if(u){if(u.length===1)return u[0];a(this,"type",t,s,{issues:ge(u)}),t.typed=!0}else{if(o?.length===1)return o[0];a(this,"type",t,s,{issues:ge(o)})}return t}}}function rn(n){return{kind:"schema",type:"void",reference:rn,expects:"void",async:!1,message:n,get"~standard"(){return m(this)},"~run"(e,t){return e.value===void 0?e.typed=!0:a(this,"type",e,t),e}}}function ke(n,e,t){let s=n["~run"]({value:e},F(t));if(s.issues)throw new _(s.issues);return s.value}function ee(...n){return{...n[0],pipe:n,get"~standard"(){return m(this)},"~run"(e,t){for(let s of n)if(s.kind!=="metadata"){if(e.issues&&(s.kind==="schema"||s.kind==="transformation")){e.typed=!1;break}(!e.issues||!t.abortEarly&&!t.abortPipeEarly)&&(e=s["~run"](e,t))}return e}}}function J(n,e,t){let s=n["~run"]({value:e},F(t));return{typed:s.typed,success:!s.issues,output:s.value,issues:s.issues}}function Nn(n){let e="";for(let t of n){e&&(e+=`
`),e+=`\xD7 ${t.message}`;let s=he(t);s&&(e+=`
  \u2192 at ${s}`)}return e}var Ln=100,we=300,Oe=(r=>(r.Disabled="disabled",r.Day="day",r.Week="week",r.Month="month",r))(Oe||{}),Ur='/[|\\t\\n\\r\\^"= -#%-*,.`\\/<>:;?@[-\\]_{}\\u00A0\\u00A1\\u00A7\\u00AB\\u00B6\\u00B7\\u00BB\\u00BF\\u037E\\u0387\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u09FD\\u0A76\\u0AF0\\u0C77\\u0C84\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F14\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1360-\\u1368\\u1400\\u166E\\u1680\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CC0-\\u1CC7\\u1CD3\\u2000-\\u200A\\u2010-\\u2029\\u202F-\\u2043\\u2045-\\u2051\\u2053-\\u205F\\u207D\\u207E\\u208D\\u208E\\u2308-\\u230B\\u2329\\u232A\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30-\\u2E4F\\u3000-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA8FC\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uAAF0\\uAAF1\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uFF3F\\uFF5B\\uFF5D\\uFF5F-\\uFF65]/'.slice(1,-1),Fn=new RegExp(`${Ur}+`,"u"),Kn=/[|\[\]\(\)<>\{\} \t\n\r]/u;var $n=!1,Ie=null,ce=Ye(()=>sn([v(),C(),N(),nn(),Y(v(),ce),K(ce)])),zn=$({content:O(C(),1),basename:O(C(),10),displayName:O(C(),10),directory:O(C(),7),aliases:O(C(),1),tags:O(C(),1)}),Un=$({weights:O(zn,ke(zn,{})),weightCustomProperties:O(Y(v(),C()),{}),recencyBoost:O(Ze(Oe),"disabled"),downrankedFoldersFilters:O(K(v()),[]),ignoreDiacritics:O(N(),!0),ignoreArabicDiacritics:O(N(),!1),tokenizeUrls:O(N(),!0),splitCamelCase:O(N(),!0),fuzziness:O(Z(["0","1","2"]),"1"),renderLineReturnInExcerpts:O(N(),!0),tokenizers:O(Y(ee(v(),Xe()),Y(v(),ce)),{})});async function z(){if(Ie)return Ie;let n=await fe.getConfig("silversearch",{}),e=J(Un,n);if(e.success)Ie=e.output;else{if(!$n){let t=Object.entries(Vn(e.issues).nested??{}).map(([s,r])=>r?`${r.join(" & ")} in "${s}"`:"").filter(s=>s).join("; ");await R.flashNotification(`Silersearch - There was an error in your CONFIG: ${t}`),$n=!0}Ie=ke(Un,{})}return Ie}var Gr=["\\u30FC","\\u309A","\\u3099"],Jr=Gr.join("|"),Gn=new RegExp(`(?!${Jr})\\p{Diacritic}`,"gu");function Jn(n){return n.replace(/(\*|_)+(.+?)(\*|_)+/g,(e,t,s)=>s)}function on(n){return/[a-z][A-Z]/.test(n)?n.replace(/([a-z](?=[A-Z]))/g,"$1 ").split(" ").filter(t=>t):[]}function an(n){return n.includes("-")?n.split("-").filter(e=>e):[]}function U(n,e=!1){if(n==null)return"";if(e){n=n.replace(/([^\u0621-\u063A\u0641-\u064A\u0660-\u0669a-zA-Z 0-9])/g,"").replace(/(||)/g,"\u0627").replace(/()/g,"\u0647").replace(/(|)/g,"\u0621").replace(/()/g,"\u064A");for(let t=0;t<10;t++)n.replace(String.fromCharCode(1632+t),String.fromCharCode(48+t))}return n=n.replaceAll("`","[__silversearch__backtick__]"),n=n.replaceAll("^","[__silversearch__caret__]"),n=n.normalize("NFD").replace(Gn,"").normalize("NFC"),n=n.replaceAll("[__silversearch__backtick__]","`"),n=n.replaceAll("[__silversearch__caret__]","^"),n}function Hn(n){return n.replace(new RegExp(`(?!\\^|\`)${Gn.source}`,"gu"),"")}function Xn(n){let e=[],t=-1,s=0;for(;++s<100;){let r=Hr(n,t,we);if(!r.length)break;t=r.at(-1).offset,e.push(r)}return e}function Hr(n,e,t){let s=n.find(r=>r.offset>e);return s?n.filter(r=>r.offset>e&&r.offset<=s.offset+t):[]}var Xr=/\r\n?|\n/g,Qr=/\0/g;function pn(n){let e=n;return e=e.replace(Xr,`
`),e=e.replace(Qr,"\uFFFD"),e}var In=(n,e)=>{let t=0,s=0,r=0;for(;t<n.length&&s<e.length;)n[t]===e[s]&&(r+=1,t+=1),s+=1;return n.slice(0,r)};var Zn=n=>n.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),Zr=({link:n,startSyntax:e,endSyntax:t,links:s})=>{if(n.startsWith(e)){if(n.endsWith(t))return!1;if(n.includes(t)){let o=n.replace(/.?http/g,"http").substring(0,n.lastIndexOf(t)).replace(new RegExp(`\\${t}$`,"g"),"");return!s.some(i=>i.href===o)}}return!0},Yr=n=>{let e=/mailto:([^\s[;]+)/g;return n.map(t=>t.href.match(e)||t.href.includes("@")?{...t,href:t.href.startsWith("mailto")?t.href:`mailto:${t.href}`,type:"email"}:t)},Qn=n=>n.startsWith("http")||n.startsWith("/")||n.includes("@"),cn=({line:n,url:e,lineLinks:t=[]})=>{var s;let r=((s=n?.match(new RegExp(Zn(e),"g")))===null||s===void 0?void 0:s.length)||0,u=t?.reduce((o,i)=>o+(i.href.includes(e)?1:0)+(i.format==="[]()"&&i.text.includes(e)?1:0),0);return r>0&&u<r},eu=({line:n,links:e,link:t})=>{var s,r;let u="",o=(((s=t?.match(/https:\/\/.*/g))===null||s===void 0?void 0:s[0])||"").replace("https://","");for(let i of e){let p=In(o,i.href);p.length>u.length&&(u=p)}if(u.length>0){let i=((r=n?.match(new RegExp(Zn(u),"g")))===null||r===void 0?void 0:r.length)||0,p=e?.reduce((I,l)=>I+(l.href.includes(u)?1:0)+(l.format==="[]()"&&l.text.includes(u)?1:0),0);return i>0&&p<i}return!0},mn=n=>{var e,t,s,r;let u=pn(n).split(`
`),o=/.?\[([^\]]*)\]\(([^\][]*)\)/g,i=/<[^>]*>/g,p=/.?\(([^)]*)\)/g,I=/.?https?:\/\/[^\s[;]+/g,l=[];for(let d of u){let f=d.match(o)||[],T=d.match(i)||[],k=d.match(p)||[],y=d.match(I)||[],h=[];for(let x of f)if(!x.startsWith("!")){let g=x?.replace(/^.?\[/g,"[")||"",w=g.indexOf("["),A=g.indexOf("]",w+1),B=g;if(w!==-1&&A!==-1&&g[A+1]==="("){let bt=A+1,Pe=0,Ee=-1;for(let me=bt;me<g.length;me+=1){let hn=g[me];if(hn==="(")Pe+=1;else if(hn===")"&&(Pe-=1,Pe===0)){Ee=me;break}}Ee!==-1&&(B=g.slice(0,Ee+1))}let M=/\[([^\]]*)\]/,D=(((e=B?.match(M))===null||e===void 0?void 0:e[1])||"").trim(),Bt=(((s=(t=B?.replace(M,""))===null||t===void 0?void 0:t.match(/\(([^\][]*)\)$/))===null||s===void 0?void 0:s[1])||"").trim(),yn={text:D,href:Bt,line:d,raw:B,type:"link",format:"[]()"};l.push(yn),h.push(yn)}for(let x of T){let g=(((r=x.match(/<([^>]*)>/))===null||r===void 0?void 0:r[1])||"").trim();if(Qn(g)){let w=g;if(cn({line:d,url:w,lineLinks:h})){let A={text:g,href:w,line:d,raw:x,type:"link",format:"<>"};l.push(A),h.push(A)}}}for(let x of k){let g=x.replace(/^.?\(/g,"("),w=g.match(/\(([^)]*)\)/),A=(w?.[1]||"").trim();if(!x.startsWith("]")&&Qn(A)){let B=A;if(cn({line:d,url:B,lineLinks:h})){let M={text:A,href:B,line:d,raw:g,type:"link",format:"()"};l.push(M),h.push(M)}}}for(let x of y)if([{start:"[",end:"]"},{start:"<",end:">"},{start:"(",end:")"}].every(w=>Zr({link:x,startSyntax:w.start,endSyntax:w.end,links:h}))&&eu({line:d,links:h,link:x})){let w=x.replace(/^.?http/g,"http"),A=w;if(cn({line:d,url:A,lineLinks:h})){let B={text:w,href:A,line:d,raw:w,type:"link",format:"raw"};l.push(B),h.push(B)}}}return Yr(l)};var nu=$({init:ee(ae(),ie(pe([ce])),Qe(rn())),isTokenizable:ee(ae(),ie(pe([v()])),xe(N())),tokenize:ee(ae(),ie(pe([v()])),xe(K(v())))}),Se=class n{constructor(e){this.implementation=e}static async loadFromPath(e,t){let s;try{s=await import(`/.fs/${e}`)}catch{return console.warn(`[Silversearch] Failed to load tokenizer at ${e}. Maybe the path is wrong?`),null}let r=J(nu,s);if(r.success){let u=new n(r.output);return await u.implementation.init(t),u}else return console.warn(`[Silversearch] Failed to load tokenizer at ${e}. 
 ${Nn(r.issues)}`),null}tryTokenization(e){try{if(this.implementation.isTokenizable(e))return this.implementation.tokenize(e)}catch(t){console.warn(`[Silversearch] Tokenizer failed with error ${t}. Ignoring!`)}return null}};function Yn(n,e){try{let t=nt(n,e.tokenizers),s=[];return e.tokenizeUrls&&(s=mn(n).map(o=>o.href)),[...tt(n).flatMap(o=>[o,...an(o),...on(o)]),...t,...s]}catch(t){return console.error("[Silversearch] Error tokenizing text, skipping document",t),[]}}function et(n,e){let t=mn(n).map(r=>r.href);n=t.reduce((r,u)=>r.replace(u,""),n);let s=[...tt(n),...t];return{combineWith:"OR",queries:[{combineWith:"AND",queries:s},{combineWith:"AND",queries:nt(n,e.tokenizers)},{combineWith:"AND",queries:s.flatMap(an)},{combineWith:"AND",queries:s.flatMap(on)}]}}function nt(n,e){return tu(n,e)??n.split(Kn).filter(Boolean)}function tt(n){return n.split(Fn).filter(Boolean)}function tu(n,e){let t=e.flatMap(s=>s.tryTokenization(n)??[]);return t.length===0?null:t}function st(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function su(n){if(!n.length)return/^$/g;n.sort((t,s)=>s.length-t.length);let e=`(${n.map(t=>`\\b${st(t)}\\b|${st(t)}`).join("|")})`;return new RegExp(`${e}`,"gui")}function rt(n,e){if(n=ut(n),e.renderLineReturnInExcerpts){let t=new RegExp(/(?:\r\n|\r|\n)/g);n=n.split(t).filter(s=>s).join(`
`),n=n.replaceAll(`
`,"<br>")}return n.trim()}async function fn(n,e,t){let s=await z();e=e.map(ut);let r=su(e),u=n;s.ignoreDiacritics&&(n=U(n,s.ignoreArabicDiacritics));let o=new Date().getTime(),i=null,p=[],I=0;for(;(i=r.exec(n))!==null&&!(++I>=100||new Date().getTime()-o>50);){let l=i.index,d=l+i[0].length,f=u.substring(l,d).trim();f&&i.index>=0&&p.push({match:f,offset:i.index})}if(t&&(t.query.text.length>1||t.getExactTerms().length>0)){let l=n.indexOf(t.getBestStringForExcerpt());l>-1&&p.find(d=>d.offset===l)&&p.unshift({offset:l,match:t.getBestStringForExcerpt()})}return p.map(l=>({...l,match:rt(l.match,{renderLineReturnInExcerpts:s.renderLineReturnInExcerpts})}))}async function dn(n,e){let t=await z();try{let s=Math.max(0,e-Ln),r=Math.min(n.length,e+we);if(n=(s>0?"\u2026":"")+n.slice(s,r).trim()+(r<n.length-1?"\u2026":""),t.renderLineReturnInExcerpts){let u=n.lastIndexOf(`
`,e-s);u>0&&(n=n.slice(u+1))}return{excerpt:rt(n,{renderLineReturnInExcerpts:t.renderLineReturnInExcerpts}),offset:e}}catch(s){return console.error("[Silversearch] Error while creating excerpt",s),{excerpt:"",offset:0}}}function ut(n){return n.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function ru(n){return n!==""?n.split(".").pop().toLowerCase():"md"}function L(n){return uu({path:n})}function ne(n){return ru(n)==="md"}function uu(n){let e=n.path;return ne(n.path)&&(e=e.slice(0,-3)),n.details?.type==="linecolumn"?(e+=`@L${n.details.line}`,n.details.column!==1&&(e+=`C${n.details.column}`)):n.details?.type==="position"?e+=`@${n.details.pos}`:n.details?.type==="header"&&(e+=`#${n.details.header}`),e}function ot(n){return n.split("/").slice(0,-1).join("/")}function it(n){return n.split("/").pop()}var ou=$({content:v(),cacheMode:O(Z(["persistent","session"]),"session"),navigationMap:O(K(tn({type:en("range"),from:C(),to:C(),tail:v()})))});async function at(n,e){if(ne(n))try{return{content:await V.readPage(L(n)),cacheMode:"session"}}catch{return null}else{let t;try{t=e??await V.getDocumentMeta(L(n))}catch{return null}let s;try{s=await de.dispatchEvent("silversearch:index",{meta:t})}catch{return console.warn("[silversearch] Eventhandler threw error. Discarding it."),null}if(s.length===0)return null;s.length>1&&console.warn(`[silversearch] We got multiple responses while indexing ${t.name}. Can't handle that.`);let r=J(ou,s[0]);return r.success?r.output:(console.warn("[silversearch] Eventhandler didn't return well-formed result. Discarding it."),null)}}var pt=4,te=class n{minisearch;entryCache;tokenizers;constructor(e,t){this.minisearch=new Q(n.getOptions(e,t)),this.entryCache=new Map,this.tokenizers=t}static async create(e){let t=(await Promise.all(Object.entries(e.tokenizers).map(async([s,r])=>await Se.loadFromPath(s,r)))).filter(s=>s!==null);return new n(e,t)}static async loadFromCache(e){if(await W.get("silversearch-cache-lock"))return await R.flashNotification("Silversearch - Last cache failed, resetting index"),n.deleteCache(),null;let t=await W.get("silversearch-cache");if(!t||t.version!==pt||typeof t.minisearch!="string"||typeof t.entries!="object")return console.log("[Silversearch] Couldn't find cache or cache version mismatched"),n.deleteCache(),null;let s=await this.create(e);return s.minisearch=await Q.loadJSONAsync(t.minisearch,n.getOptions(e,s.tokenizers)),s.entryCache=new Map(t.entries),s}static async deleteCache(){await W.del("silversearch-cache"),await W.del("silversearch-cache-lock")}cacheWritingTimer=0;async writeToCache(){clearTimeout(this.cacheWritingTimer),await W.set("silversearch-cache-lock",!0),this.cacheWritingTimer=setTimeout(async()=>{await W.set("silversearch-cache",{version:pt,minisearch:JSON.stringify(this.minisearch),entries:Array.from(this.entryCache.entries()).filter(e=>e[1].cacheMode==="persistent")}),await W.set("silversearch-cache-lock",!1)},250)}async reindex(e=!1){e||await R.flashNotification("Silversearch - Reindexing, this can cause performance problems"),this.minisearch.removeAll();let t=(await V.listFiles()).map(s=>s.name).filter(this.isIndexedPath);e||console.log(`[Silversearch] Indexing ${t.length} pages`),e||await R.showProgress(0,"index"),await this.indexByPaths(t,(s,r)=>{e||R.showProgress(Math.round(s/r*100),"index"),W.set("silversearch-progress",{done:s,all:r})}),W.del("silversearch-progress"),e||await R.showProgress(),e||await R.flashNotification("Silversearch - Full reindex done!")}async indexByPath(e){await this.indexByPaths([e])}async indexByPaths(e,t){let s=0;for(let r of e)try{console.log(`[Silversearch] Indexing ${L(r)}`),this.entryCache.delete(r);let u=await this.getCacheEntry(r);if(!u)throw null;this.minisearch.has(u.path)?this.minisearch.replace(u):this.minisearch.add(u),t&&t(++s,e.length)}catch{console.warn(`[Silversearch] Failed to index ${L(r)}. Skipping!`)}await this.writeToCache()}async deleteByPath(e){await this.deleteByPaths([e])}async deleteByPaths(e){for(let t of e)try{this.minisearch.discard(t)}catch{console.error("[Silversearch] Something went wrong. Failed to delete page")}await this.writeToCache()}async search(e,t){let s=await z();if(e.isEmpty())return[];let r={0:0,1:.1,2:.2}[s.fuzziness],u=et(e.segmentsToStr(),{tokenizers:this.tokenizers}),o=this.minisearch.search(u,{prefix:d=>d.length>=t.prefixLength,fuzzy:d=>d.length<=3?0:d.length<=5?r/2:r,boost:{basename:s.weights.basename,aliases:s.weights.aliases,displayName:s.weights.displayName,directory:s.weights.directory,tags:s.weights.tags,unmarkedTags:s.weights.tags},tokenize:d=>[d],boostDocument(d,f,T){if(!T?.lastModified||s.recencyBoost==="disabled")return 1;let k=T?.lastModified,h=(new Date().getTime()-k)/(24*3600*1e3),x={day:-3,week:-.3,month:-.1};return 1+Math.exp(x[s.recencyBoost]*(h/1e3))}});if(e.query.ext?.length&&(o=o.filter(d=>{let f=d.id.includes(".")?"."+d.id.split(".").pop():".md";return e.query.ext?.some(T=>f.startsWith(T.startsWith(".")?T:"."+T))})),e.query.path&&(o=o.filter(d=>e.query.path?.some(f=>d.id.toLowerCase().includes(f.toLowerCase())))),e.query.exclude.path&&(o=o.filter(d=>!e.query.exclude.path?.some(f=>d.id.toLowerCase().includes(f.toLowerCase())))),!o.length)return[];if(t.singleFilePath)return o.filter(d=>d.id===t.singleFilePath);let i=await this.getCacheEntries(o.map(d=>d.id)),p=e.getTags();for(let d of o){let f=d.id,T=L(f);s.downrankedFoldersFilters.length>0&&(s.downrankedFoldersFilters.some(h=>T===h||T.startsWith(h+"/"))||T.split("/").some(h=>s.downrankedFoldersFilters.includes(h)))&&(d.score/=10);let k=i.find(y=>y.path===f);if(k)for(let[y,h]of Object.entries(s.weightCustomProperties)){let x=k.metadata[y];x&&d.terms.some(g=>x.includes(g))&&(d.score*=h)}for(let y of p)(k?.tags??[]).includes(y)&&(d.score*=100)}o=o.sort((d,f)=>f.score-d.score).slice(0,50);let I=e.getExactTerms();I.length&&(o=o.filter(d=>{let f=i.find(y=>y.path===d.id),T=f?.name.toLowerCase()??"",k=(f?.cleanedContent??"").toLowerCase();return I.every(y=>k.includes(y)||U(T,s.ignoreArabicDiacritics).includes(y))}));let l=e.query.exclude.text;return l.length&&(o=o.filter(d=>{let f=(i.find(T=>T.path===d.id)?.content??"").toLowerCase();return l.every(T=>!f.includes(T))})),o}async getSuggestions(e,t){let s=await this.search(e,{prefixLength:1,singleFilePath:t?.singleFilePath}),r=await this.getCacheEntries(s.map(o=>o.id));return(await Promise.all(s.map(async o=>{let i=r.find(T=>T.path===o.id);if(!i)return console.warn(`[Silversearch] Note "${o.name}" disappeared. Skipping`),null;let p=[...o.terms,...e.getExactTerms(),...e.getTags()],I=await fn(i.content,p,e),l=await fn(i.name,p),d;if(t?.singleFilePath){let T=Xn(I),k=e.getExactTerms();k.length&&(T=T.filter(h=>k.every(x=>h.some(g=>g.match.includes(x)))));let y=T.map(h=>Math.round(h.at(0).offset));d=await Promise.all(y.map(h=>dn(i?.content??"",h)))}else d=[await dn(i.content,I[0]?.offset??0)];return{score:o.score,foundWords:p,matches:I,matchesName:l,excerpts:d,name:i.name,basename:i.basename,content:i.content,navigationMap:i.navigationMap}}))).filter(o=>o!==null)}async getCacheEntries(e){return(await Promise.all(e.map(s=>this.getCacheEntry(s)))).filter(s=>!!s)}async getCacheEntry(e){let t,s=this.entryCache.get(e);if(s)return s;try{let i=L(e);t=ne(e)?await V.getPageMeta(i):await V.getDocumentMeta(i)}catch{return console.log("[Silversearch] Couldn't find the specified file:",e),null}let r=await n.pathToIndexableEntry(e,t);if(!r)return null;let u=Object.fromEntries(Object.entries(t).filter(([i,p])=>!["ref","tag","tags","itags","name","created","lastModified","perm","lastOpened","pageDecoration","aliases","extension","size","contentType"].includes(i))),o={...r.entry,...r.info,cleanedContent:Jn(U(r.entry.content)),metadata:u,tags:t.tags?.map(i=>"#"+i)??[]};return this.entryCache.set(e,o),o}static async pathToIndexableEntry(e,t){let s=L(e),r;try{r=t??(ne(e)?await V.getPageMeta(s):await V.getDocumentMeta(s))}catch{return null}let u=await at(e,r);if(!u)return null;let o=Hn(u.content),i={path:e,name:s,content:o,basename:it(s),directory:ot(s),aliases:r.aliases??[],displayName:r.displayName??"",unmarkedTags:r.tags??[],lastModified:new Date(r.lastModified).getTime()},{content:p,...I}=u;return{entry:i,info:I}}isIndexedPath(e){return!e.endsWith(".plug.js")}static getOptions(e,t){return{tokenize:s=>Yn(s,{tokenizers:t,tokenizeUrls:e.tokenizeUrls}),processTerm:s=>(e.ignoreDiacritics?U(s,e.ignoreArabicDiacritics):s).toLowerCase(),idField:"path",fields:["content","basename","directory","aliases","displayName","unmarkedTags"],storeFields:["lastModified"]}}};var ft=_t(mt()),ln=["ext","path"],Be=class{query;#e;constructor(e="",t){t.ignoreDiacritics&&(e=U(e,t.ignoreArabicDiacritics));let s=(0,ft.parse)(e.toLowerCase(),{tokenize:!0,keywords:ln});s.text=s.text??[],s.exclude=s.exclude??{text:[]},s.exclude.text=s.exclude.text??[],Array.isArray(s.exclude.text)||(s.exclude.text=[s.exclude.text]),s.exclude.text=s.exclude.text.filter(u=>u.length);for(let u of ln){let o=s[u];o&&(s[u]=Array.isArray(o)?o:[o]);let i=s.exclude[u];i&&(s.exclude[u]=Array.isArray(i)?i:[i])}this.query=s;let r=this.query.text.filter(u=>u.startsWith(".")).map(u=>u.slice(1));this.query.ext=[...new Set([...r,...this.query.ext??[]])],this.query.text=this.query.text.filter(u=>!u.startsWith(".")),this.#e=e.match(/"([^"]+)"/g)?.map(u=>u.replace(/"/g,""))??[]}isEmpty(){for(let e of ln)if(this.query[e]?.length||this.query.text.length)return!1;return!0}segmentsToStr(){return this.query.text.join(" ")}getTags(){return this.query.text.filter(e=>e.startsWith("#"))}getTagsWithoutHashtag(){return this.getTags().map(e=>e.replace(/^#/,""))}getExactTerms(){return[...new Set([...this.query.text.filter(e=>e.split(" ").length>1),...this.#e].map(e=>e.toLowerCase()))]}getBestStringForExcerpt(){return this.#e.length?this.#e.sort((e,t)=>t.length-e.length)[0]??"":this.segmentsToStr()}};var dt="1.2.0";var E=null,H=[],be=null;function Tn(n=!0,e=!1){return be||(be=iu(n,e).then(()=>{be=null})),be}async function iu(n,e){if(E)return;let t=await z();E=await te.loadFromCache(t),!E&&n?(E=await te.create(t),await E.reindex(e)):E&&H.length&&(await E.indexByPaths(H.filter(s=>s.action==="index").map(s=>s.path)),await E.deleteByPaths(H.filter(s=>s.action==="delete").map(s=>s.path))),H=[]}async function lt(n=""){await R.showPanel("modal",1,Sn,n?`globalThis.DEFAULT_QUERY = ${JSON.stringify(n)};`+De:De)}async function Tt(){await c("silversearch.openSearch")}async function yt(){await Tn(!1)}async function ht({name:n}){let e=`${n}.md`;E?await E.indexByPath(e):H.push({action:"index",path:e})}async function xt(n){let e=n;E?await E.indexByPath(e):H.push({action:"index",path:e})}async function gt(n){E?await E.deleteByPath(n):H.push({action:"delete",path:n})}async function kt(n,e){await Tn(!0,e.silent??!1);let t=await z(),s=new Be(n,{ignoreDiacritics:t.ignoreDiacritics,ignoreArabicDiacritics:t.ignoreArabicDiacritics});return E.getSuggestions(s,{singleFilePath:e.singleFilePath})}async function wt(n=!1){await te.deleteCache(),E=null,await Tn(!0,n)}async function Ot(){await R.flashNotification(`Silversearch - Version ${dt}`)}var St={startSearch:Tt,getVersion:Ot,openSearch:lt,reindex:wt,init:yt,indexPage:ht,indexDocument:xt,deleted:gt,search:kt},At={name:"silversearch",functions:{startSearch:{path:"./worker/silversearch.ts:startSearch",command:{name:"Silversearch: Search",key:"Ctrl-s",mac:"Cmd-s"}},getVersion:{path:"./worker/silversearch.ts:showVersion",command:{name:"Silversearch: Version"}},openSearch:{path:"./worker/silversearch.ts:openSearch",syscall:"silversearch.openSearch"},reindex:{path:"./worker/silversearch.ts:reindex",syscall:"silversearch.reindex",command:{name:"Silversearch: Reindex"}},init:{path:"./worker/silversearch.ts:init",events:["editor:init"]},indexPage:{path:"./worker/silversearch.ts:indexPage",events:["page:index"]},indexDocument:{path:"./worker/silversearch.ts:indexDocument",events:["document:index"]},deleted:{path:"./worker/silversearch.ts:deleted",events:["file:deleted"]},search:{path:"./worker/silversearch.ts:search",syscall:"silversearch.search"}},assets:{}},$E={manifest:At,functionMapping:St};On(St,At,self.postMessage);export{$E as plug};
/*! Bundled license information:

search-query-parser/lib/search-query-parser.js:
  (*!
   * search-query-parser.js
   * Copyright(c) 2014-2019
   * MIT Licensed
   *)
*/
//# sourceMappingURL=silversearch.plug.js.map
